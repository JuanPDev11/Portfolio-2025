(function(){"use strict";var ie,Te,E=Math.abs,ke=Math.sin,pe=Math.cos,he=Math.max,oe=Math.min,yt=Math.ceil,Ue=Math.sqrt,Pe=Math.pow,qe={},ze={},ot={0:"0,",1:"17,",2:"34,",3:"51,",4:"68,",5:"85,",6:"102,",7:"119,",8:"136,",9:"153,",a:"170,",A:"170,",b:"187,",B:"187,",c:"204,",C:"204,",d:"221,",D:"221,",e:"238,",E:"238,",f:"255,",F:"255,"},ae,B,R,Je,De,Ze,Ve,K=document,Oe,X,et,ue={};for(ie=0;ie<256;++ie)Te=ie.toString(16),ie<16&&(Te="0"+Te),ze[Te]=ze[Te.toUpperCase()]=ie.toString()+",";function be(i){return typeof i<"u"}function We(i){return typeof i=="object"&&i!=null}function se(i,n,a){return isNaN(i)?a:oe(a,he(n,i))}function Ne(){return!1}function xe(){return new Date().valueOf()}function Mt(i,n){var a=[],r=i.length,h;for(h=0;h<r;++h)a.push(i[h]);return a.sort(n),a}function je(i){for(var n=i.length-1,a,r;n;)r=~~(Math.random()*n),a=i[n],i[n]=i[r],i[r]=a,--n}function we(){var i=window.AudioContext||window.webkitAudioContext;if(X=new i,!X){X="off";return}return X}function tt(i,n,a,r,h,f,m){var g=r,v=h,b=a*.01,T=80*b,S=100*b,D=40*b,I=30*b,_=I/2,U=g+T,ee=U-D,ce=v+S,te=ce-I,Q=v+I,le=v+S/2;if(n.setTransform(1,0,0,1,0,0),n.setLineDash([]),n.globalAlpha=1,n.strokeStyle=m,n.lineWidth=f,n.lineJoin="round",n.beginPath(),n.moveTo(ee,Q),n.lineTo(ee,te),n.moveTo(U,ce),n.lineTo(ee,te),n.lineTo(g,te),n.lineTo(g,Q),n.lineTo(ee,Q),n.lineTo(U,v),i){n.lineTo(U,Q),n.moveTo(U,te),n.lineTo(U,ce),n.moveTo(U-_,le-_),n.lineTo(U+_,le+_),n.moveTo(U+_,le-_),n.lineTo(U-_,le+_),n.stroke();return}n.closePath(),n.stroke()}function Se(i,n,a){this.x=i,this.y=n,this.z=a}De=Se.prototype,De.length=function(){return Ue(this.x*this.x+this.y*this.y+this.z*this.z)},De.dot=function(i){return this.x*i.x+this.y*i.y+this.z*i.z},De.cross=function(i){var n=this.y*i.z-this.z*i.y,a=this.z*i.x-this.x*i.z,r=this.x*i.y-this.y*i.x;return new Se(n,a,r)},De.angle=function(i){var n=this.dot(i),a;return n==0?Math.PI/2:(a=n/(this.length()*i.length()),a>=1?0:a<=-1?Math.PI:Math.acos(a))},De.unit=function(){var i=this.length();return new Se(this.x/i,this.y/i,this.z/i)};function It(i,n){n=n*Math.PI/180,i=i*Math.PI/180;var a=ke(i)*pe(n),r=-ke(n),h=-pe(i)*pe(n);return new Se(a,r,h)}function de(i){this[1]={1:i[0],2:i[1],3:i[2]},this[2]={1:i[3],2:i[4],3:i[5]},this[3]={1:i[6],2:i[7],3:i[8]}}Je=de.prototype,de.Identity=function(){return new de([1,0,0,0,1,0,0,0,1])},de.Rotation=function(i,n){var a=ke(i),r=pe(i),h=1-r;return new de([r+Pe(n.x,2)*h,n.x*n.y*h-n.z*a,n.x*n.z*h+n.y*a,n.y*n.x*h+n.z*a,r+Pe(n.y,2)*h,n.y*n.z*h-n.x*a,n.z*n.x*h-n.y*a,n.z*n.y*h+n.x*a,r+Pe(n.z,2)*h])},Je.mul=function(i){var n=[],a,r,h=i.xform?1:0;for(a=1;a<=3;++a)for(r=1;r<=3;++r)h?n.push(this[a][1]*i[1][r]+this[a][2]*i[2][r]+this[a][3]*i[3][r]):n.push(this[a][r]*i);return new de(n)},Je.xform=function(i){var n={},a=i.x,r=i.y,h=i.z;return n.x=a*this[1][1]+r*this[2][1]+h*this[3][1],n.y=a*this[1][2]+r*this[2][2]+h*this[3][2],n.z=a*this[1][3]+r*this[2][3]+h*this[3][3],n};function Lt(i,n,a,r,h){var f,m,g,v,b=[],T=2/i,S;for(S=Math.PI*(3-Ue(5)+(parseFloat(h)?parseFloat(h):0)),f=0;f<i;++f)m=f*T-1+T/2,g=Ue(1-m*m),v=f*S,b.push([pe(v)*g*n,m*a,ke(v)*g*r]);return b}function at(i,n,a,r,h,f){var m,g=[],v=2/i,b,T,S,D,I;for(b=Math.PI*(3-Ue(5)+(parseFloat(f)?parseFloat(f):0)),T=0;T<i;++T)S=T*v-1+v/2,m=T*b,D=pe(m),I=ke(m),g.push(n?[S*a,D*r,I*h]:[D*a,S*r,I*h]);return g}function lt(i,n,a,r,h,f){var m,g=[],v=Math.PI*2/n,b,T,S;for(b=0;b<n;++b)m=b*v,T=pe(m),S=ke(m),g.push(i?[f*a,T*r,S*h]:[T*a,f*r,S*h]);return g}function Dt(i,n,a,r,h){return at(i,0,n,a,r,h)}function bt(i,n,a,r,h){return at(i,1,n,a,r,h)}function Ot(i,n,a,r,h){return h=isNaN(h)?0:h*1,lt(0,i,n,a,r,h)}function Nt(i,n,a,r,h){return h=isNaN(h)?0:h*1,lt(1,i,n,a,r,h)}function _t(i){var n=new Image;n.onload=function(){var a=n.width/2,r=n.height/2;i.centreFunc=function(h,f,m,g,v){h.setTransform(1,0,0,1,0,0),h.globalAlpha=1,h.drawImage(n,g-a,v-r)}},n.src=i.centreImage}function Rt(i,n){var a=i,r,h,f=(n*1).toPrecision(3)+")";return i[0]==="#"?(qe[i]||(i.length===4?qe[i]="rgba("+ot[i[1]]+ot[i[2]]+ot[i[3]]:qe[i]="rgba("+ze[i.substr(1,2)]+ze[i.substr(3,2)]+ze[i.substr(5,2)]),a=qe[i]+f):i.substr(0,4)==="rgb("||i.substr(0,4)==="hsl("?a=i.replace("(","a(").replace(")",","+f):(i.substr(0,5)==="rgba("||i.substr(0,5)==="hsla(")&&(r=i.lastIndexOf(",")+1,h=i.indexOf(")"),n*=parseFloat(i.substring(r,h)),a=i.substr(0,r)+n.toPrecision(3)+")"),a}function ge(i,n){if(window.G_vmlCanvasManager)return null;var a=K.createElement("canvas");return a.width=i,a.height=n,a}function $t(){var i=ge(3,3),n,a;return!!i&&(n=i.getContext("2d"),n.strokeStyle="#000",n.shadowColor="#fff",n.shadowBlur=3,n.globalAlpha=0,n.strokeRect(2,2,2,2),n.globalAlpha=1,a=n.getImageData(2,2,1,1),i=null,a.data[0]>0)}function zt(i,n,a,r){var h=i.createLinearGradient(0,0,n,0),f;for(f in r)h.addColorStop(1-f,r[f]);i.fillStyle=h,i.fillRect(0,a,n,1)}function Ye(i,n,a){var r=1024,h=1,f=i.weightGradient,m,g,v,b;if(i.gCanvas)g=i.gCanvas.getContext("2d"),h=i.gCanvas.height;else{if(We(f[0])?h=f.length:f=[f],i.gCanvas=m=ge(r,h),!m)return null;for(g=m.getContext("2d"),v=0;v<h;++v)zt(g,r,v,f[v])}return a=he(oe(a||0,h-1),0),b=g.getImageData(~~((r-1)*n),a,1,1).data,"rgba("+b[0]+","+b[1]+","+b[2]+","+b[3]/255+")"}function jt(i,n,a,r,h,f,m,g,v,b,T,S){var D=h+(g||0)+(v.length&&v[0]<0?E(v[0]):0),I=f+(g||0)+(v.length&&v[1]<0?E(v[1]):0),_,U;for(i.font=n,i.textBaseline="top",i.fillStyle=a,m&&(i.shadowColor=m),g&&(i.shadowBlur=g),v.length&&(i.shadowOffsetX=v[0],i.shadowOffsetY=v[1]),_=0;_<r.length;++_)U=0,T&&(S=="right"?U=b-T[_]:S=="centre"&&(U=(b-T[_])/2)),i.fillText(r[_],D+U,I),I+=parseInt(n)}function u(i,n,a,r,h,f,m){f?(i.beginPath(),i.moveTo(n,a+h-f),i.arcTo(n,a,n+f,a,f),i.arcTo(n+r,a,n+r,a+f,f),i.arcTo(n+r,a+h,n+r-f,a+h,f),i.arcTo(n,a+h,n,a+h-f,f),i.closePath(),i[m?"stroke":"fill"]()):i[m?"strokeRect":"fillRect"](n,a,r,h)}function Ke(i,n,a,r,h,f,m,g,v){this.strings=i,this.font=n,this.width=a,this.height=r,this.maxWidth=h,this.stringWidths=f,this.align=m,this.valign=g,this.scale=v}Ve=Ke.prototype,Ve.SetImage=function(i,n,a,r,h,f,m,g){this.image=i,this.iwidth=n*this.scale,this.iheight=a*this.scale,this.ipos=r,this.ipad=h*this.scale,this.iscale=g,this.ialign=f,this.ivalign=m},Ve.Align=function(i,n,a){var r=0;return a=="right"||a=="bottom"?r=n-i:a!="left"&&a!="top"&&(r=(n-i)/2),r},Ve.Create=function(i,n,a,r,h,f,m,g,v){var b,T,S,D,I,_,U,ee,ce,te,Q,le,ve,Ie,dt,ft=E(m[0]),re=E(m[1]),Le,$e;return g=he(g,ft+f,re+f),I=2*(g+r),U=2*(g+r),T=this.width+I,S=this.height+U,ce=te=g+r,this.image&&(Q=le=g+r,ve=this.iwidth,Ie=this.iheight,this.ipos=="top"||this.ipos=="bottom"?(ve<this.width?Q+=this.Align(ve,this.width,this.ialign):ce+=this.Align(this.width,ve,this.align),this.ipos=="top"?te+=Ie+this.ipad:le+=this.height+this.ipad,T=he(T,ve+I),S+=Ie+this.ipad):(Ie<this.height?le+=this.Align(Ie,this.height,this.ivalign):te+=this.Align(this.height,Ie,this.valign),this.ipos=="right"?Q+=this.width+this.ipad:ce+=ve+this.ipad,T+=ve+this.ipad,S=he(S,Ie+U))),b=ge(T,S),b?(I=U=r/2,_=T-r,ee=S-r,dt=oe(v,_/2,ee/2),D=b.getContext("2d"),n&&(D.fillStyle=n,u(D,I,U,_,ee,dt)),r&&(D.strokeStyle=a,D.lineWidth=r,u(D,I,U,_,ee,dt,!0)),(f||ft||re)&&(Le=ge(T,S),Le&&($e=D,D=Le.getContext("2d"))),jt(D,this.font,i,this.strings,ce,te,0,0,[],this.maxWidth,this.stringWidths,this.align),this.image&&D.drawImage(this.image,Q,le,ve,Ie),$e&&(D=$e,h&&(D.shadowColor=h),f&&(D.shadowBlur=f),D.shadowOffsetX=m[0],D.shadowOffsetY=m[1],D.drawImage(Le,0,0)),b):null};function Xe(i,n,a){var r=ge(n,a),h;return r?(h=r.getContext("2d"),h.drawImage(i,(n-i.width)/2,(a-i.height)/2),r):null}function ht(i,n,a){var r=ge(n,a),h;return r?(h=r.getContext("2d"),h.drawImage(i,0,0,n,a),r):null}function wt(i,n,a,r,h,f,m,g,v,b){var T=n+(2*g+f)*r,S=a+(2*g+f)*r,D=ge(T,S),I,_,U,ee,ce,te,Q,le;return D?(f*=r,v*=r,_=U=f/2,ee=T-f,ce=S-f,g=g*r+_,I=D.getContext("2d"),le=oe(v,ee/2,ce/2),h&&(I.fillStyle=h,u(I,_,U,ee,ce,le)),f&&(I.strokeStyle=m,I.lineWidth=f,u(I,_,U,ee,ce,le,!0)),b?(te=ge(T,S),Q=te.getContext("2d"),Q.drawImage(i,g,g,n,a),Q.globalCompositeOperation="source-in",Q.fillStyle=m,Q.fillRect(0,0,T,S),Q.globalCompositeOperation="destination-over",Q.drawImage(D,0,0),Q.globalCompositeOperation="source-over",I.drawImage(te,0,0)):I.drawImage(i,g,g,i.width,i.height),{image:D,width:T/r,height:S/r}):null}function Ft(i,n,a,r,h){var f,m,g=parseFloat(n),v=he(a,r);return f=ge(a,r),f?(n.indexOf("%")>0?g=v*g/100:g=g*h,m=f.getContext("2d"),m.globalCompositeOperation="source-over",m.fillStyle="#fff",g>=v/2?(g=oe(a,r)/2,m.beginPath(),m.moveTo(a/2,r/2),m.arc(a/2,r/2,g,0,2*Math.PI,!1),m.fill(),m.closePath()):(g=oe(a/2,r/2,g),u(m,0,0,a,r,g,!0),m.fill()),m.globalCompositeOperation="source-in",m.drawImage(i,0,0,a,r),f):null}function Ht(i,n,a,r,h,f,m){var g=E(m[0]),v=E(m[1]),b=n+(g>f?g+f:f*2)*r,T=a+(v>f?v+f:f*2)*r,S=r*((f||0)+(m[0]<0?g:0)),D=r*((f||0)+(m[1]<0?v:0)),I,_;return I=ge(b,T),I?(_=I.getContext("2d"),h&&(_.shadowColor=h),f&&(_.shadowBlur=f*r),m&&(_.shadowOffsetX=m[0]*r,_.shadowOffsetY=m[1]*r),_.drawImage(i,S,D,n,a),{image:I,width:b/r,height:T/r}):null}function vt(i,n,a){var r=parseInt(i.toString().length*a),h=parseInt(a*2*i.length),f=ge(r,h),m,g,v,b,T,S,D,I;if(!f)return null;for(m=f.getContext("2d"),m.fillStyle="#000",m.fillRect(0,0,r,h),jt(m,a+"px "+n,"#fff",i,0,0,0,0,[],"centre"),g=m.getImageData(0,0,r,h),v=g.width,b=g.height,I={min:{x:v,y:b},max:{x:-1,y:-1}},S=0;S<b;++S)for(T=0;T<v;++T)D=(S*v+T)*4,g.data[D+1]>0&&(T<I.min.x&&(I.min.x=T),T>I.max.x&&(I.max.x=T),S<I.min.y&&(I.min.y=S),S>I.max.y&&(I.max.y=S));return v!=r&&(I.min.x*=r/v,I.max.x*=r/v),b!=h&&(I.min.y*=r/b,I.max.y*=r/b),f=null,I}function ct(i){return"'"+i.replace(/(\'|\")/g,"").replace(/\s*,\s*/g,"', '")+"'"}function G(i,n,a){a=a||K,a.addEventListener?a.addEventListener(i,n,!1):a.attachEvent("on"+i,n)}function Bt(i,n,a){a=a||K,a.removeEventListener?a.removeEventListener(i,n):a.detachEvent("on"+i,n)}function Fe(i,n,a,r,h){var f=h.imageScale,m,g,v,b,T,S;if(!n.complete)return G("load",function(){Fe(i,n,a,r,h)},n);if(!i.complete)return G("load",function(){Fe(i,n,a,r,h)},i);if(a&&!a.complete)return G("load",function(){Fe(i,n,a,r,h)},a);n.width=n.width,n.height=n.height,f&&(i.width=n.width*f,i.height=n.height*f),r.iw=i.width,r.ih=i.height,h.txtOpt&&(g=i,m=h.zoomMax*h.txtScale,T=r.iw*m,S=r.ih*m,T<n.naturalWidth||S<n.naturalHeight?(g=ht(i,T,S),g&&(r.fimage=g)):(T=r.iw,S=r.ih,m=1),parseFloat(h.imageRadius)&&(r.image=r.fimage=i=Ft(r.image,h.imageRadius,T,S,m)),r.HasText()||(h.shadow&&(g=Ht(r.image,T,S,m,h.shadow,h.shadowBlur,h.shadowOffset),g&&(r.fimage=g.image,r.w=g.width,r.h=g.height)),(h.bgColour||h.bgOutlineThickness)&&(v=h.bgColour=="tag"?j(r.a,"background-color"):h.bgColour,b=h.bgOutline=="tag"?j(r.a,"color"):h.bgOutline||h.textColour,T=r.fimage.width,S=r.fimage.height,h.outlineMethod=="colour"&&(g=wt(r.fimage,T,S,m,v,h.bgOutlineThickness,r.outline.colour,h.padding,h.bgRadius,1),g&&(r.oimage=g.image)),g=wt(r.fimage,T,S,m,v,h.bgOutlineThickness,b,h.padding,h.bgRadius),g&&(r.fimage=g.image,r.w=g.width,r.h=g.height)),h.outlineMethod=="size"&&(h.outlineIncrease>0?(r.iw+=2*h.outlineIncrease,r.ih+=2*h.outlineIncrease,T=m*r.iw,S=m*r.ih,g=ht(r.fimage,T,S),r.oimage=g,r.fimage=Xe(r.fimage,r.oimage.width,r.oimage.height)):(T=m*(r.iw+2*h.outlineIncrease),S=m*(r.ih+2*h.outlineIncrease),g=ht(r.fimage,T,S),r.oimage=Xe(g,r.fimage.width,r.fimage.height))))),r.alt=a,r.Init()}function j(i,n){var a=K.defaultView,r=n.replace(/\-([a-z])/g,function(h){return h.charAt(1).toUpperCase()});return a&&a.getComputedStyle&&a.getComputedStyle(i,null).getPropertyValue(n)||i.currentStyle&&i.currentStyle[r]}function Tt(i,n,a){var r=1,h;return n?r=1*(i.getAttribute(n)||a):(h=j(i,"font-size"))&&(r=h.indexOf("px")>-1&&h.replace("px","")*1||h.indexOf("pt")>-1&&h.replace("pt","")*1.25||h*3.3),r}function Ce(i){return i.target&&be(i.target.id)?i.target.id:i.srcElement.parentNode.id}function O(i,n){var a,r,h=parseInt(j(n,"width"))/n.width,f=parseInt(j(n,"height"))/n.height;return be(i.offsetX)?a={x:i.offsetX,y:i.offsetY}:(r=rt(n.id),be(i.changedTouches)&&(i=i.changedTouches[0]),i.pageX&&(a={x:i.pageX-r.x,y:i.pageY-r.y})),a&&h&&f&&(a.x/=h,a.y/=f),a}function Ut(i){var n=i.target||i.fromElement.parentNode,a=A.tc[n.id];a&&(a.mx=a.my=-1,a.UnFreeze(),a.EndDrag())}function ut(i){var n,a=A,r,h,f=Ce(i);for(n in a.tc)r=a.tc[n],r.tttimer&&(clearTimeout(r.tttimer),r.tttimer=null);f&&a.tc[f]&&(r=a.tc[f],(h=O(i,r.canvas))&&(r.mx=h.x,r.my=h.y,r.Drag(i,h)),r.drawn=0)}function Ae(i){var n=A,a=K.addEventListener?0:1,r=Ce(i);r&&i.button==a&&n.tc[r]&&n.tc[r].BeginDrag(i)}function it(i){var n=A,a=K.addEventListener?0:1,r=Ce(i),h;r&&i.button==a&&n.tc[r]&&(h=n.tc[r],ut(i),!h.EndDrag()&&!h.touchState&&h.Clicked(i))}function st(i){var n=Ce(i),a=n&&A.tc[n],r;a&&i.changedTouches&&(i.touches.length==1&&a.touchState==0?(a.touchState=1,a.BeginDrag(i),(r=O(i,a.canvas))&&(a.mx=r.x,a.my=r.y,a.drawn=0)):i.targetTouches.length==2&&a.pinchZoom?(a.touchState=3,a.EndDrag(),a.BeginPinch(i)):(a.EndDrag(),a.EndPinch(),a.touchState=0))}function ye(i){var n=Ce(i),a=n&&A.tc[n];if(a&&i.changedTouches){switch(a.touchState){case 1:a.Draw(),a.Clicked();break;case 2:a.EndDrag();break;case 3:a.EndPinch()}a.touchState=0}}function _e(i){var n,a=A,r,h,f=Ce(i);for(n in a.tc)r=a.tc[n],r.tttimer&&(clearTimeout(r.tttimer),r.tttimer=null);if(r=f&&a.tc[f],r&&i.changedTouches&&r.touchState){switch(r.touchState){case 1:case 2:(h=O(i,r.canvas))&&(r.mx=h.x,r.my=h.y,r.Drag(i,h)&&(r.touchState=2));break;case 3:r.Pinch(i)}r.drawn=0}}function F(i){var n=A,a=Ce(i);a&&n.tc[a]&&(i.cancelBubble=!0,i.returnValue=!1,i.preventDefault&&i.preventDefault(),n.tc[a].Wheel((i.wheelDelta||i.detail)>0))}function nt(i){var n,a=A;clearTimeout(a.scrollTimer);for(n in a.tc)a.tc[n].Pause();a.scrollTimer=setTimeout(function(){var r,h=A;for(r in h.tc)h.tc[r].Resume()},a.scrollPause)}function Re(){kt(xe())}function kt(i){var n=A.tc,a;A.NextFrame(A.interval),i=i||xe();for(a in n)n[a].Draw(i)}function Ge(){requestAnimationFrame(kt)}function ne(i){setTimeout(Re,i)}function rt(i){var n=K.getElementById(i),a=n.getBoundingClientRect(),r=K.documentElement,h=K.body,f=window,m=f.pageXOffset||r.scrollLeft,g=f.pageYOffset||r.scrollTop,v=r.clientLeft||h.clientLeft,b=r.clientTop||h.clientTop;return{x:a.left+m-v,y:a.top+g-b}}function xt(i,n,a,r){var h=i.radius*i.z1/(i.z1+i.z2+n.z);return{x:n.x*h*a,y:n.y*h*r,z:n.z,w:(i.z1-n.z)/i.z2}}function J(i){this.e=i,this.br=0,this.line=[],this.text=[],this.original=i.innerText||i.textContent}Ze=J.prototype,Ze.Empty=function(){for(var i=0;i<this.text.length;++i)if(this.text[i].length)return!1;return!0},Ze.Lines=function(i){var n=i?1:0,a,r,h;for(i=i||this.e,a=i.childNodes,r=a.length,h=0;h<r;++h)a[h].nodeName=="BR"?(this.text.push(this.line.join(" ")),this.br=1):a[h].nodeType==3?this.br?(this.line=[a[h].nodeValue],this.br=0):this.line.push(a[h].nodeValue):this.Lines(a[h]);return n||this.br||this.text.push(this.line.join(" ")),this.text},Ze.SplitWidth=function(i,n,a,r){var h,f,m,g=[];for(n.font=r+"px "+a,h=0;h<this.text.length;++h){for(m=this.text[h].split(/\s+/),this.line=[m[0]],f=1;f<m.length;++f)n.measureText(this.line.join(" ")+" "+m[f]).width>i?(g.push(this.line.join(" ")),this.line=[m[f]]):this.line.push(m[f]);g.push(this.line.join(" "))}return this.text=g};function St(i,n){this.ts=null,this.tc=i,this.tag=n,this.x=this.y=this.w=this.h=this.sc=1,this.z=0,this.pulse=1,this.pulsate=i.pulsateTo<1,this.colour=i.outlineColour,this.adash=~~i.outlineDash,this.agap=~~i.outlineDashSpace||this.adash,this.aspeed=i.outlineDashSpeed*1,this.colour=="tag"?this.colour=j(n.a,"color"):this.colour=="tagbg"&&(this.colour=j(n.a,"background-color")),this.Draw=this.pulsate?this.DrawPulsate:this.DrawSimple,this.radius=i.outlineRadius|0,this.SetMethod(i.outlineMethod,i.altImage)}ae=St.prototype,ae.SetMethod=function(i,n){var a={block:["PreDraw","DrawBlock"],colour:["PreDraw","DrawColour"],outline:["PostDraw","DrawOutline"],classic:["LastDraw","DrawOutline"],size:["PreDraw","DrawSize"],none:["LastDraw"]},r=a[i]||a.outline;i=="none"?this.Draw=function(){return 1}:this.drawFunc=this[r[1]],this[r[0]]=this.Draw,n&&(this.RealPreDraw=this.PreDraw,this.PreDraw=this.DrawAlt)},ae.Update=function(i,n,a,r,h,f,m,g){var v=this.tc.outlineOffset,b=2*v;this.x=h*i+m-v,this.y=h*n+g-v,this.w=h*a+b,this.h=h*r+b,this.sc=h,this.z=f},ae.Ants=function(i){if(this.adash){var n=this.adash,a=this.agap,r=this.aspeed,h=n+a,f=0,m=n,g=a,v=0,b=0,T;r&&(b=E(r)*(xe()-this.ts)/50,r<0&&(b=864e4-b),r=~~b%h),r?(n>=r?(f=n-r,m=r):(g=h-r,v=a-g),T=[f,g,m,v]):T=[n,a],i.setLineDash(T)}},ae.DrawOutline=function(i,n,a,r,h,f){var m=oe(this.radius,h/2,r/2);i.strokeStyle=f,this.Ants(i),u(i,n,a,r,h,m,!0)},ae.DrawSize=function(i,n,a,r,h,f,m,g,v){var b=m.w,T=m.h,S,D,I;return this.pulsate?(m.image?I=(m.image.height+this.tc.outlineIncrease)/m.image.height:I=m.oscale,D=m.fimage||m.image,S=1+(I-1)*(1-this.pulse),m.h*=S,m.w*=S):D=m.oimage,m.alpha=1,m.Draw(i,g,v,D),m.h=T,m.w=b,1},ae.DrawColour=function(i,n,a,r,h,f,m,g,v){return m.oimage?(this.pulse<1?(m.alpha=1-Pe(this.pulse,2),m.Draw(i,g,v,m.fimage),m.alpha=this.pulse):m.alpha=1,m.Draw(i,g,v,m.oimage),1):this[m.image?"DrawColourImage":"DrawColourText"](i,n,a,r,h,f,m,g,v)},ae.DrawColourText=function(i,n,a,r,h,f,m,g,v){var b=m.colour;return m.colour=f,m.alpha=1,m.Draw(i,g,v),m.colour=b,1},ae.DrawColourImage=function(i,n,a,r,h,f,m,g,v){var b=i.canvas,T=~~he(n,0),S=~~he(a,0),D=oe(b.width-T,r)+.5|0,I=oe(b.height-S,h)+.5|0,_;return Oe?(Oe.width=D,Oe.height=I):Oe=ge(D,I),Oe?(_=Oe.getContext("2d"),_.drawImage(b,T,S,D,I,0,0,D,I),i.clearRect(T,S,D,I),this.pulsate?m.alpha=1-Pe(this.pulse,2):m.alpha=1,m.Draw(i,g,v),i.setTransform(1,0,0,1,0,0),i.save(),i.beginPath(),i.rect(T,S,D,I),i.clip(),i.globalCompositeOperation="source-in",i.fillStyle=f,i.fillRect(T,S,D,I),i.restore(),i.globalAlpha=1,i.globalCompositeOperation="destination-over",i.drawImage(Oe,0,0,D,I,T,S,D,I),i.globalCompositeOperation="source-over",1):this.SetMethod("outline")},ae.DrawAlt=function(i,n,a,r,h,f){var m=this.RealPreDraw(i,n,a,r,h,f);return n.alt&&(n.DrawImage(i,a,r,n.alt),m=1),m},ae.DrawBlock=function(i,n,a,r,h,f){var m=oe(this.radius,h/2,r/2);i.fillStyle=f,u(i,n,a,r,h,m)},ae.DrawSimple=function(i,n,a,r,h,f){var m=this.tc;return i.setTransform(1,0,0,1,0,0),i.strokeStyle=this.colour,i.lineWidth=m.outlineThickness,i.shadowBlur=i.shadowOffsetX=i.shadowOffsetY=0,i.globalAlpha=f?h:1,this.drawFunc(i,this.x,this.y,this.w,this.h,this.colour,n,a,r)},ae.DrawPulsate=function(i,n,a,r){var h=xe()-this.ts,f=this.tc,m=f.pulsateTo+(1-f.pulsateTo)*(.5+pe(2*Math.PI*h/(1e3*f.pulsateTime))/2);return this.pulse=m=A.Smooth(1,m),this.DrawSimple(i,n,a,r,m,1)},ae.Active=function(i,n,a){var r=n>=this.x&&a>=this.y&&n<=this.x+this.w&&a<=this.y+this.h;return r?this.ts=this.ts||xe():this.ts=null,r},ae.PreDraw=ae.PostDraw=ae.LastDraw=Ne;function Me(i,n,a,r,h,f,m,g,v,b,T,S,D,I){this.tc=i,this.image=null,this.text=n,this.text_original=I,this.line_widths=[],this.title=a.title||null,this.a=a,this.position=new Se(r[0],r[1],r[2]),this.x=this.y=this.z=0,this.w=h,this.h=f,this.colour=m||i.textColour,this.bgColour=g||i.bgColour,this.bgRadius=v|0,this.bgOutline=b||this.colour,this.bgOutlineThickness=T|0,this.textFont=S||i.textFont,this.padding=D|0,this.sc=this.alpha=1,this.weighted=!i.weight,this.outline=new St(i,this),this.audio=null}B=Me.prototype,B.Init=function(i){var n=this.tc;this.textHeight=n.textHeight,this.HasText()?this.Measure(n.ctxt,n):(this.w=this.iw,this.h=this.ih),this.SetShadowColour=n.shadowAlpha?this.SetShadowColourAlpha:this.SetShadowColourFixed,this.SetDraw(n)},B.Draw=Ne,B.HasText=function(){return this.text&&this.text[0].length>0},B.EqualTo=function(i){var n=i.getElementsByTagName("img");return this.a.href!=i.href?0:n.length?this.image.src==n[0].src:(i.innerText||i.textContent)==this.text_original},B.SetImage=function(i){this.image=this.fimage=i},B.SetAudio=function(i){this.audio=i,this.audio.load()},B.SetDraw=function(i){this.Draw=this.fimage?i.ie>7?this.DrawImageIE:this.DrawImage:this.DrawText,i.noSelect&&(this.CheckActive=Ne)},B.MeasureText=function(i){var n,a=this.text.length,r=0,h;for(n=0;n<a;++n)this.line_widths[n]=h=i.measureText(this.text[n]).width,r=he(r,h);return r},B.Measure=function(i,n){var a=vt(this.text,this.textFont,this.textHeight),r,h,f,m,g,v,b,T,S;b=a?a.max.y+a.min.y:this.textHeight,i.font=this.font=this.textHeight+"px "+this.textFont,v=this.MeasureText(i),n.txtOpt&&(r=n.txtScale,h=r*this.textHeight,f=h+"px "+this.textFont,m=[r*n.shadowOffset[0],r*n.shadowOffset[1]],i.font=f,g=this.MeasureText(i),S=new Ke(this.text,f,g+r,r*b+r,g,this.line_widths,n.textAlign,n.textVAlign,r),this.image&&S.SetImage(this.image,this.iw,this.ih,n.imagePosition,n.imagePadding,n.imageAlign,n.imageVAlign,n.imageScale),T=S.Create(this.colour,this.bgColour,this.bgOutline,r*this.bgOutlineThickness,n.shadow,r*n.shadowBlur,m,r*this.padding,r*this.bgRadius),n.outlineMethod=="colour"?this.oimage=S.Create(this.outline.colour,this.bgColour,this.outline.colour,r*this.bgOutlineThickness,n.shadow,r*n.shadowBlur,m,r*this.padding,r*this.bgRadius):n.outlineMethod=="size"&&(a=vt(this.text,this.textFont,this.textHeight+n.outlineIncrease),h=a.max.y+a.min.y,f=r*(this.textHeight+n.outlineIncrease)+"px "+this.textFont,i.font=f,g=this.MeasureText(i),S=new Ke(this.text,f,g+r,r*h+r,g,this.line_widths,n.textAlign,n.textVAlign,r),this.image&&S.SetImage(this.image,this.iw+n.outlineIncrease,this.ih+n.outlineIncrease,n.imagePosition,n.imagePadding,n.imageAlign,n.imageVAlign,n.imageScale),this.oimage=S.Create(this.colour,this.bgColour,this.bgOutline,r*this.bgOutlineThickness,n.shadow,r*n.shadowBlur,m,r*this.padding,r*this.bgRadius),this.oscale=this.oimage.width/T.width,n.outlineIncrease>0?T=Xe(T,this.oimage.width,this.oimage.height):this.oimage=Xe(this.oimage,T.width,T.height)),T&&(this.fimage=T,v=this.fimage.width/r,b=this.fimage.height/r),this.SetDraw(n),n.txtOpt=!!this.fimage),this.h=b,this.w=v},B.SetFont=function(i,n,a,r){this.textFont=i,this.colour=n,this.bgColour=a,this.bgOutline=r,this.Measure(this.tc.ctxt,this.tc)},B.SetWeight=function(i){var n=this.tc,a=n.weightMode.split(/[, ]/),r,h,f=i.length;if(this.HasText()){for(this.weighted=!0,h=0;h<f;++h)r=a[h]||"size",r=="both"?(this.Weight(i[h],n.ctxt,n,"size",n.min_weight[h],n.max_weight[h],h),this.Weight(i[h],n.ctxt,n,"colour",n.min_weight[h],n.max_weight[h],h)):this.Weight(i[h],n.ctxt,n,r,n.min_weight[h],n.max_weight[h],h);this.Measure(n.ctxt,n)}},B.Weight=function(i,n,a,r,h,f,m){i=isNaN(i)?1:i;var g=(i-h)/(f-h);r=="colour"?this.colour=Ye(a,g,m):r=="bgcolour"?this.bgColour=Ye(a,g,m):r=="bgoutline"?this.bgOutline=Ye(a,g,m):r=="outline"?this.outline.colour=Ye(a,g,m):r=="size"&&(a.weightSizeMin>0&&a.weightSizeMax>a.weightSizeMin?this.textHeight=a.weightSize*(a.weightSizeMin+(a.weightSizeMax-a.weightSizeMin)*g):this.textHeight=he(1,i*a.weightSize))},B.SetShadowColourFixed=function(i,n,a){i.shadowColor=n},B.SetShadowColourAlpha=function(i,n,a){i.shadowColor=Rt(n,a)},B.DrawText=function(i,n,a){var r=this.tc,h=this.x,f=this.y,m=this.sc,g,v;for(i.globalAlpha=this.alpha,i.fillStyle=this.colour,r.shadow&&this.SetShadowColour(i,r.shadow,this.alpha),i.font=this.font,h+=n/m,f+=a/m-this.h/2,g=0;g<this.text.length;++g)v=h,r.textAlign=="right"?v+=this.w/2-this.line_widths[g]:r.textAlign=="centre"?v-=this.line_widths[g]/2:v-=this.w/2,i.setTransform(m,0,0,m,m*v,m*f),i.fillText(this.text[g],0,0),f+=this.textHeight},B.DrawImage=function(i,n,a,r){var h=this.x,f=this.y,m=this.sc,g=r||this.fimage,v=this.w,b=this.h,T=this.alpha,S=this.shadow;i.globalAlpha=T,S&&this.SetShadowColour(i,S,T),h+=n/m-v/2,f+=a/m-b/2,i.setTransform(m,0,0,m,m*h,m*f),i.drawImage(g,0,0,v,b)},B.DrawImageIE=function(i,n,a){var r=this.fimage,h=this.sc,f=r.width=this.w*h,m=r.height=this.h*h,g=this.x*h+n-f/2,v=this.y*h+a-m/2;i.setTransform(1,0,0,1,0,0),i.globalAlpha=this.alpha,i.drawImage(r,g,v)},B.Calc=function(i,n){var a,r=this.tc,h=r.minBrightness,f=r.maxBrightness,m=r.max_radius;return a=i.xform(this.position),this.xformed=a,a=xt(r,a,r.stretchX,r.stretchY),this.x=a.x,this.y=a.y,this.z=a.z,this.sc=a.w,this.alpha=n*se(h+(f-h)*(m-this.z)/(2*m),0,1),this.xformed},B.UpdateActive=function(i,n,a){var r=this.outline,h=this.w,f=this.h,m=this.x-h/2,g=this.y-f/2;return r.Update(m,g,h,f,this.sc,this.z,n,a),r},B.CheckActive=function(i,n,a){var r=this.tc,h=this.UpdateActive(i,n,a);return h.Active(i,r.mx,r.my)?h:null},B.Clicked=function(i){var n=this.a,a=n.target,r=n.href,h;if(a!=""&&a!="_self"){if(self.frames[a])self.frames[a].document.location=r;else{try{if(top.frames[a]){top.frames[a].document.location=r;return}}catch{}window.open(r,a)}return}if(K.createEvent){if(h=K.createEvent("MouseEvents"),h.initMouseEvent("click",1,1,window,0,0,0,0,0,0,0,0,0,0,null),!n.dispatchEvent(h))return}else if(n.fireEvent&&!n.fireEvent("onclick"))return;K.location=r},B.StopAudio=function(){this.audio&&this.playing&&this.audio.pause(),this.stopped=1,this.playing=0},B.PlayAudio=function(){if(!(X==="off"||this.tc.audioOff)&&!(!X&&!we())){var i=this.tc.audio,n=this.tc.gain,a="suspended",r;if(this.audio&&(this.track||(this.track=X.createMediaElementSource(this.audio),this.gain=X.createGain(),this.track.connect(this.gain),this.gain.connect(X.destination)),i=this.audio,n=this.gain,!i.paused))return 1;if(i)return X.state==a&&X.resume(),X.state==a?void 0:(n.gain.value=oe(2,he(0,this.tc.audioVolume*1)),i.currentTime=0,this.stopped=0,r=i.play(),r!==void 0&&r.then(h=>{this.stopped?this.audio.pause():this.playing=1}),1)}};function A(i,n,a){var r,h,f=K.getElementById(i),m=["id","class","innerHTML"];if(!f)throw 0;if(be(window.G_vmlCanvasManager)&&(f=window.G_vmlCanvasManager.initElement(f),this.ie=parseFloat(navigator.appVersion.split("MSIE")[1])),f&&(!f.getContext||!f.getContext("2d").fillText)){for(h=K.createElement("DIV"),r=0;r<m.length;++r)h[m[r]]=f[m[r]];throw f.parentNode.insertBefore(h,f),f.parentNode.removeChild(f),0}for(r in A.options)this[r]=a&&be(a[r])?a[r]:be(A[r])?A[r]:A.options[r];if(this.canvas=f,this.ctxt=f.getContext("2d"),this.z1=250/he(this.depth,.001),this.z2=this.z1/this.zoom,this.radius=oe(f.height,f.width)*.0075,this.max_radius=100,this.max_weight=[],this.min_weight=[],this.textFont=this.textFont&&ct(this.textFont),this.textHeight*=1,this.imageRadius=this.imageRadius.toString(),this.pulsateTo=se(this.pulsateTo,0,1),this.minBrightness=se(this.minBrightness,0,1),this.maxBrightness=se(this.maxBrightness,this.minBrightness,1),this.ctxt.textBaseline="top",this.lx=(this.lock+"").indexOf("x")+1,this.ly=(this.lock+"").indexOf("y")+1,this.frozen=this.dx=this.dy=this.fixedAnim=this.touchState=0,this.fixedAlpha=1,this.source=n||i,this.repeatTags=oe(64,~~this.repeatTags),this.minTags=oe(200,~~this.minTags),~~this.scrollPause>0?A.scrollPause=~~this.scrollPause:this.scrollPause=0,this.minTags>0&&this.repeatTags<1&&(r=this.GetTags().length)&&(this.repeatTags=yt(this.minTags/r)-1),this.transform=de.Identity(),this.startTime=this.time=xe(),this.mx=this.my=-1,this.centreImage&&_t(this),this.Animate=this.dragControl?this.AnimateDrag:this.AnimatePosition,this.animTiming=typeof A[this.animTiming]=="function"?A[this.animTiming]:A.Smooth,this.shadowBlur||this.shadowOffset[0]||this.shadowOffset[1]?(this.ctxt.shadowColor=this.shadow,this.shadow=this.ctxt.shadowColor,this.shadowAlpha=$t()):delete this.shadow,this.activeAudio===!1?X="off":this.activeAudio&&this.LoadAudio(),this.Load(),n&&this.hideTags&&function(g){A.loaded?g.HideTags():G("load",function(){g.HideTags()},window)}(this),this.yaw=this.initial?this.initial[0]*this.maxSpeed:0,this.pitch=this.initial?this.initial[1]*this.maxSpeed:0,this.tooltip?(this.ctitle=f.title,f.title="",this.tooltip=="native"?this.Tooltip=this.TooltipNative:(this.Tooltip=this.TooltipDiv,this.ttdiv||(this.ttdiv=K.createElement("div"),this.ttdiv.className=this.tooltipClass,this.ttdiv.style.position="absolute",this.ttdiv.style.zIndex=f.style.zIndex+1,G("mouseover",function(g){g.target.style.display="none"},this.ttdiv),K.body.appendChild(this.ttdiv)))):this.Tooltip=this.TooltipNone,!this.noMouse&&!ue[i])for(ue[i]=[["mousemove",ut],["mouseout",Ut],["mouseup",it],["touchstart",st],["touchend",ye],["touchcancel",ye],["touchmove",_e]],this.dragControl&&(ue[i].push(["mousedown",Ae]),ue[i].push(["selectstart",Ne])),this.wheelZoom&&(ue[i].push(["mousewheel",F]),ue[i].push(["DOMMouseScroll",F])),this.scrollPause&&ue[i].push(["scroll",nt,window]),r=0;r<ue[i].length;++r)h=ue[i][r],G(h[0],h[1],h[2]?h[2]:f);A.started||(A.NextFrame=window.requestAnimationFrame?Ge:ne,A.interval=this.interval,A.NextFrame(this.interval),A.started=1)}R=A.prototype,R.SourceElements=function(){return K.querySelectorAll?K.querySelectorAll("#"+this.source):[K.getElementById(this.source)]},R.HideTags=function(){var i=this.SourceElements(),n;for(n=0;n<i.length;++n)i[n].style.display="none"},R.GetTags=function(){var i=this.SourceElements(),n,a=[],r,h,f;for(f=0;f<=this.repeatTags;++f)for(r=0;r<i.length;++r)for(n=i[r].getElementsByTagName("a"),h=0;h<n.length;++h)a.push(n[h]);return a},R.Message=function(i){var n=[],a,r,h=i.split(""),f,m,g,v;for(a=0;a<h.length;++a)h[a]!=" "&&(r=a-h.length/2,f=K.createElement("A"),f.href="#",f.innerText=h[a],g=100*ke(r/9),v=-100*pe(r/9),m=new Me(this,h[a],f,[g,0,v],2,18,"#000","#fff",0,0,0,"monospace",2,h[a]),m.Init(),n.push(m));return n},R.AddAudio=function(i,n){if(X!=="off"){var a=i.getElementsByTagName("audio");a.length&&(n.SetAudio(a[0]),this.hasAudio=1)}},R.CreateTag=function(i){var n,a,r,h,f,m,g,v,b=[0,0,0],T;if(this.imageMode!="text"&&(n=i.getElementsByTagName("img"),n.length&&(a=new Image,a.src=n[0].src,!this.imageMode)))return r=new Me(this,"",i,b,0,0),r.SetImage(a),Fe(a,n[0],n[1],r,this),this.AddAudio(i,r),r;if(this.imageMode!="image"&&(f=new J(i),h=f.Lines(),f.Empty()?f=null:(m=this.textFont||ct(j(i,"font-family")),this.splitWidth&&(h=f.SplitWidth(this.splitWidth,this.ctxt,m,this.textHeight)),g=this.bgColour=="tag"?j(i,"background-color"):this.bgColour,v=this.bgOutline=="tag"?j(i,"color"):this.bgOutline)),f||a)return r=new Me(this,h,i,b,2,this.textHeight+2,this.textColour||j(i,"color"),g,this.bgRadius,v,this.bgOutlineThickness,m,this.padding,f&&f.original),a?(r.SetImage(a),Fe(a,n[0],n[1],r,this)):r.Init(),this.AddAudio(i,r),r},R.UpdateTag=function(i,n){var a=this.textColour||j(n,"color"),r=this.textFont||ct(j(n,"font-family")),h=this.bgColour=="tag"?j(n,"background-color"):this.bgColour,f=this.bgOutline=="tag"?j(n,"color"):this.bgOutline;i.a=n,i.title=n.title,(i.colour!=a||i.textFont!=r||i.bgColour!=h||i.bgOutline!=f)&&i.SetFont(r,a,h,f)},R.Weight=function(i){var n=i.length,a,r,h,f=[],m,g=this.weightFrom?this.weightFrom.split(/[, ]/):[null],v=g.length;for(r=0;r<n;++r)for(f[r]=[],h=0;h<v;++h)a=Tt(i[r].a,g[h],this.textHeight),(!this.max_weight[h]||a>this.max_weight[h])&&(this.max_weight[h]=a),(!this.min_weight[h]||a<this.min_weight[h])&&(this.min_weight[h]=a),f[r][h]=a;for(h=0;h<v;++h)this.max_weight[h]>this.min_weight[h]&&(m=1);if(m)for(r=0;r<n;++r)i[r].SetWeight(f[r])},R.Load=function(){var i=this.GetTags(),n=[],a,r,h,f,m,g,v,b,T=[],S={sphere:Lt,vcylinder:Dt,hcylinder:bt,vring:Ot,hring:Nt};if(i.length){for(T.length=i.length,b=0;b<i.length;++b)T[b]=b;for(this.shuffleTags&&je(T),f=100*this.radiusX,m=100*this.radiusY,g=100*this.radiusZ,this.max_radius=he(f,he(m,g)),b=0;b<i.length;++b)r=this.CreateTag(i[T[b]]),r&&n.push(r);for(this.weight&&this.Weight(n,!0),this.shapeArgs?this.shapeArgs[0]=n.length:(h=this.shape.toString().split(/[(),]/),a=h.shift(),typeof window[a]=="function"?this.shape=window[a]:this.shape=S[a]||S.sphere,this.shapeArgs=[n.length,f,m,g].concat(h)),v=this.shape.apply(this,this.shapeArgs),this.listLength=n.length,b=0;b<n.length;++b)n[b].position=new Se(v[b][0],v[b][1],v[b][2])}this.noTagsMessage&&!n.length&&(b=this.imageMode&&this.imageMode!="both"?this.imageMode+" ":"",n=this.Message("No "+b+"tags")),this.taglist=n},R.Update=function(){var i=this.GetTags(),n=[],a=this.taglist,r,h=[],f=[],m,g,v,b,T;if(!this.shapeArgs)return this.Load();if(i.length){for(v=this.listLength=i.length,g=a.length,b=0;b<g;++b)n.push(a[b]),f.push(b);for(b=0;b<v;++b){for(T=0,r=0;T<g;++T)a[T].EqualTo(i[b])&&(this.UpdateTag(n[T],i[b]),r=f[T]=-1);r||h.push(b)}for(b=0,T=0;b<g;++b)f[T]==-1?f.splice(T,1):++T;if(f.length){for(je(f);f.length&&h.length;)b=f.shift(),T=h.shift(),n[b]=this.CreateTag(i[T]);for(f.sort(function(S,D){return S-D});f.length;)n.splice(f.pop(),1)}for(T=n.length/(h.length+1),b=0;h.length;)n.splice(yt(++b*T),0,this.CreateTag(i[h.shift()]));for(this.shapeArgs[0]=v=n.length,m=this.shape.apply(this,this.shapeArgs),b=0;b<v;++b)n[b].position=new Se(m[b][0],m[b][1],m[b][2]);this.weight&&this.Weight(n)}this.taglist=n},R.SetShadow=function(i){i.shadowBlur=this.shadowBlur,i.shadowOffsetX=this.shadowOffset[0],i.shadowOffsetY=this.shadowOffset[1]},R.LoadAudio=function(){!X&&!we()||(this.audio=K.createElement("audio"),this.audio.src=this.activeAudio,this.track=X.createMediaElementSource(this.audio),this.gain=X.createGain(),this.track.connect(this.gain),this.gain.connect(X.destination),this.hasAudio=1,et=function(i){X.resume(),K.removeEventListener("click",et)},K.addEventListener("click",et))},R.ShowAudioIcon=function(){var i=this.audioIconSize,n=this.canvas,a=this.ctxt,r=n.width-i-3,h=n.height-i-3,f=this.audioIconThickness,m="#000",g="#fff",v=this.audioIconDark,b=this.audioOff,T="suspended";X&&(b||(b=X.state===T),this.audioIcon&&this.hasAudio&&(tt(b,a,i,r,h,f+1,v?g:m),tt(b,a,i,r,h,f,v?m:g)))},R.CheckAudioIcon=function(){var i=this.audioIconSize,n=this.canvas,a=this.audioIconThickness/2,r=n.width-i-3-a,h=n.height-i-3-a;if(this.audioIcon&&this.mx>=r&&this.my>=h)return!0},R.ToggleAudio=function(){var i=this.audioOff||X&&X.state==="suspended";i||this.currentAudio&&this.currentAudio.StopAudio(),this.audioOff=!i},R.Draw=function(i){if(!this.paused){var n=this.canvas,a=n.width,r=n.height,h=0,f=(i-this.time)*A.interval/1e3,m=a/2+this.offsetX,g=r/2+this.offsetY,v=this.ctxt,b,T,S,D=-1,I=this.taglist,_=I.length,U=this.active&&this.active.tag,ee="",ce=this.frontSelect,te=this.centreFunc==Ne,Q;if(this.time=i,this.frozen&&this.drawn)return this.Animate(a,r,f);for(Q=this.AnimateFixed(),v.setTransform(1,0,0,1,0,0),S=0;S<_;++S)I[S].Calc(this.transform,this.fixedAlpha);if(I=Mt(I,function(le,ve){return ve.z-le.z}),Q&&this.fixedAnim.active)b=this.fixedAnim.tag.UpdateActive(v,m,g);else if(this.active=null,this.CheckAudioIcon())ee="pointer";else{for(S=0;S<_;++S)T=this.mx>=0&&this.my>=0&&this.taglist[S].CheckActive(v,m,g),T&&T.sc>h&&(!ce||T.z<=0)&&(b=T,D=S,b.tag=this.taglist[S],h=T.sc);this.active=b}for(this.txtOpt||this.shadow&&this.SetShadow(v),v.clearRect(0,0,a,r),S=0;S<_;++S){if(!te&&I[S].z<=0){try{this.centreFunc(v,a,r,m,g)}catch(le){alert(le),this.centreFunc=Ne}te=!0}b&&b.tag==I[S]&&b.PreDraw(v,I[S],m,g)||I[S].Draw(v,m,g),b&&b.tag==I[S]&&b.PostDraw(v)}this.freezeActive&&b?this.Freeze():(this.UnFreeze(),this.drawn=_==this.listLength),this.fixedCallback&&(this.fixedCallback(this,this.fixedCallbackTag),this.fixedCallback=null),Q||this.Animate(a,r,f),b&&(b.LastDraw(v),b.tag!=U&&(this.currentAudio&&this.currentAudio!=b.tag&&this.currentAudio.StopAudio(),b.tag.PlayAudio()&&(this.currentAudio=b.tag)),ee=this.activeCursor),n.style.cursor=ee,this.Tooltip(b,this.taglist[D]),this.audioIcon&&this.ShowAudioIcon()}},R.TooltipNone=function(){},R.TooltipNative=function(i,n){i?this.canvas.title=n&&n.title?n.title:"":this.canvas.title=this.ctitle},R.SetTTDiv=function(i,n){var a=this,r=a.ttdiv.style;i!=a.ttdiv.innerHTML&&(r.display="none"),a.ttdiv.innerHTML=i,n&&(n.title=a.ttdiv.innerHTML),r.display=="none"&&!a.tttimer&&(a.tttimer=setTimeout(function(){var h=rt(a.canvas.id);r.display="block",r.left=h.x+a.mx+"px",r.top=h.y+a.my+24+"px",a.tttimer=null},a.tooltipDelay))},R.TooltipDiv=function(i,n){i&&n&&n.title?this.SetTTDiv(n.title,n):!i&&this.mx!=-1&&this.my!=-1&&this.ctitle.length?this.SetTTDiv(this.ctitle):this.ttdiv.style.display="none"},R.Transform=function(i,n,a){if(n||a){var r=ke(n),h=pe(n),f=ke(a),m=pe(a),g=new de([m,0,f,0,1,0,-f,0,m]),v=new de([1,0,0,0,h,-r,0,r,h]);i.transform=i.transform.mul(g.mul(v))}},R.AnimateFixed=function(){var i,n,a,r,h;return this.fadeIn&&(n=xe()-this.startTime,n>=this.fadeIn?(this.fadeIn=0,this.fixedAlpha=1):this.fixedAlpha=n/this.fadeIn),!!this.fixedAnim&&(this.fixedAnim.transform||(this.fixedAnim.transform=this.transform),i=this.fixedAnim,n=xe()-i.t0,a=i.angle,h=this.animTiming(i.t,n),this.transform=i.transform,n>=i.t?(this.fixedCallbackTag=i.tag,this.fixedCallback=i.cb,this.fixedAnim=this.yaw=this.pitch=0):a*=h,r=de.Rotation(a,i.axis),this.transform=this.transform.mul(r),this.fixedAnim!=0)},R.AnimatePosition=function(i,n,a){var r=this,h=r.mx,f=r.my,m,g;!r.frozen&&h>=0&&f>=0&&h<i&&f<n?(m=r.maxSpeed,g=r.reverse?-1:1,r.lx||(r.yaw=(h*2*m/i-m)*g*a),r.ly||(r.pitch=(f*2*m/n-m)*-g*a),r.initial=null):r.initial||(r.frozen&&!r.freezeDecel?r.yaw=r.pitch=0:r.Decel(r)),this.Transform(r,r.pitch,r.yaw)},R.AnimateDrag=function(i,n,a){var r=this,h=100*a*r.maxSpeed/r.max_radius/r.zoom;r.dx||r.dy?(r.lx||(r.yaw=r.dx*h/r.stretchX),r.ly||(r.pitch=r.dy*-h/r.stretchY),r.dx=r.dy=0,r.initial=null):r.initial||r.Decel(r),this.Transform(r,r.pitch,r.yaw)},R.Freeze=function(){this.frozen||(this.preFreeze=[this.yaw,this.pitch],this.frozen=1,this.drawn=0)},R.UnFreeze=function(){this.frozen&&(this.yaw=this.preFreeze[0],this.pitch=this.preFreeze[1],this.frozen=0)},R.Decel=function(i){var n=i.minSpeed,a=E(i.yaw),r=E(i.pitch);!i.lx&&a>n&&(i.yaw=a>i.z0?i.yaw*i.decel:0),!i.ly&&r>n&&(i.pitch=r>i.z0?i.pitch*i.decel:0)},R.Zoom=function(i){this.z2=this.z1*(1/i),this.drawn=0},R.Clicked=function(i){if(this.CheckAudioIcon()){this.ToggleAudio();return}var n=this.active;try{n&&n.tag&&(this.clickToFront===!1||this.clickToFront===null?n.tag.Clicked(i):this.TagToFront(n.tag,this.clickToFront,function(){n.tag.Clicked(i)},!0))}catch{}},R.Wheel=function(i){var n=this.zoom+this.zoomStep*(i?1:-1);this.zoom=oe(this.zoomMax,he(this.zoomMin,n)),this.Zoom(this.zoom)},R.BeginDrag=function(i){this.down=O(i,this.canvas),i.cancelBubble=!0,i.returnValue=!1,i.preventDefault&&i.preventDefault()},R.Drag=function(i,n){if(this.dragControl&&this.down){var a=this.dragThreshold*this.dragThreshold,r=n.x-this.down.x,h=n.y-this.down.y;(this.dragging||r*r+h*h>a)&&(this.dx=r,this.dy=h,this.dragging=1,this.down=n)}return this.dragging},R.EndDrag=function(){var i=this.dragging;return this.dragging=this.down=null,i};function Qe(i){var n=i.targetTouches[0],a=i.targetTouches[1];return Ue(Pe(a.pageX-n.pageX,2)+Pe(a.pageY-n.pageY,2))}R.BeginPinch=function(i){this.pinched=[Qe(i),this.zoom],i.preventDefault&&i.preventDefault()},R.Pinch=function(i){var n,a,r=this.pinched;r&&(a=Qe(i),n=r[1]*a/r[0],this.zoom=oe(this.zoomMax,he(this.zoomMin,n)),this.Zoom(this.zoom))},R.EndPinch=function(i){this.pinched=null},R.Pause=function(){this.paused=!0},R.Resume=function(){this.paused=!1},R.SetSpeed=function(i){this.initial=i,this.yaw=i[0]*this.maxSpeed,this.pitch=i[1]*this.maxSpeed},R.FindTag=function(i){if(!be(i))return null;if(be(i.index)&&(i=i.index),!We(i))return this.taglist[i];var n,a,r;for(be(i.id)?(n="id",a=i.id):be(i.text)&&(n="innerText",a=i.text),r=0;r<this.taglist.length;++r)if(this.taglist[r].a[n]==a)return this.taglist[r]},R.RotateTag=function(i,n,a,r,h,f){var m=i.Calc(this.transform,1),g=new Se(m.x,m.y,m.z),v=It(a,n),b=g.angle(v),T=g.cross(v).unit();b==0?(this.fixedCallbackTag=i,this.fixedCallback=h):this.fixedAnim={angle:-b,axis:T,t:r,t0:xe(),cb:h,tag:i,active:f}},R.TagToFront=function(i,n,a,r){this.RotateTag(i,0,0,n,a,r)},R.Volume=function(i){this.audioVolume=i*1},A.Start=function(i,n,a){A.Delete(i),A.tc[i]=new A(i,n,a)};function He(i,n){A.tc[n]&&A.tc[n][i]()}A.Linear=function(i,n){return n/i},A.Smooth=function(i,n){return .5-pe(n*Math.PI/i)/2},A.Pause=function(i){He("Pause",i)},A.Resume=function(i){He("Resume",i)},A.Reload=function(i){He("Load",i)},A.Update=function(i){He("Update",i)},A.SetSpeed=function(i,n){return!!(We(n)&&A.tc[i]&&!isNaN(n[0])&&!isNaN(n[1]))&&(A.tc[i].SetSpeed(n),!0)},A.TagToFront=function(i,n){return!!We(n)&&(n.lat=n.lng=0,A.RotateTag(i,n))},A.RotateTag=function(i,n){if(We(n)&&A.tc[i]){isNaN(n.time)&&(n.time=500);var a=A.tc[i].FindTag(n);if(a)return A.tc[i].RotateTag(a,n.lat,n.lng,n.time,n.callback,n.active),!0}return!1},A.Delete=function(i){var n,a;if(ue[i]&&(a=K.getElementById(i),a))for(n=0;n<ue[i].length;++n)Bt(ue[i][n][0],ue[i][n][1],a);delete ue[i],delete A.tc[i]},A.tc={},A.options={z1:2e4,z2:2e4,z0:2e-4,freezeActive:!1,freezeDecel:!1,activeCursor:"pointer",pulsateTo:1,pulsateTime:3,reverse:!1,depth:.5,maxSpeed:.05,minSpeed:0,decel:.95,interval:20,minBrightness:.1,maxBrightness:1,outlineColour:"#ffff99",outlineThickness:2,outlineOffset:5,outlineMethod:"outline",outlineRadius:0,textColour:"#ff99ff",textHeight:15,textFont:"Helvetica, Arial, sans-serif",shadow:"#000",shadowBlur:0,shadowOffset:[0,0],initial:null,hideTags:!0,zoom:1,weight:!1,weightMode:"size",weightFrom:null,weightSize:1,weightSizeMin:null,weightSizeMax:null,weightGradient:{0:"#f00",.33:"#ff0",.66:"#0f0",1:"#00f"},txtOpt:!0,txtScale:2,frontSelect:!1,wheelZoom:!0,zoomMin:.3,zoomMax:3,zoomStep:.05,shape:"sphere",lock:null,tooltip:null,tooltipDelay:300,tooltipClass:"tctooltip",radiusX:1,radiusY:1,radiusZ:1,stretchX:1,stretchY:1,offsetX:0,offsetY:0,shuffleTags:!1,noSelect:!1,noMouse:!1,imageScale:1,paused:!1,dragControl:!1,dragThreshold:4,centreFunc:Ne,splitWidth:0,animTiming:"Smooth",clickToFront:!1,fadeIn:0,padding:0,bgColour:null,bgRadius:0,bgOutline:null,bgOutlineThickness:0,outlineIncrease:4,textAlign:"centre",textVAlign:"middle",imageMode:null,imagePosition:null,imagePadding:2,imageAlign:"centre",imageVAlign:"middle",noTagsMessage:!0,centreImage:null,pinchZoom:!1,repeatTags:0,minTags:0,imageRadius:0,scrollPause:!1,outlineDash:0,outlineDashSpace:0,outlineDashSpeed:1,activeAudio:"",audioVolume:1,audioIcon:1,audioIconSize:20,audioIconThickness:2,audioIconDark:0,altImage:0};for(ie in A.options)A[ie]=A.options[ie];window.TagCanvas=A,G("load",function(){A.loaded=1},window)})(),typeof navigator=="object"&&function(ie,Te){typeof exports=="object"&&typeof module<"u"?module.exports=Te():typeof define=="function"&&define.amd?define("Plyr",Te):(ie=typeof globalThis<"u"?globalThis:ie||self,ie.Plyr=Te())}(this,function(){"use strict";(function(){if(!(typeof window>"u"))try{var e=new window.CustomEvent("test",{cancelable:!0});if(e.preventDefault(),e.defaultPrevented!==!0)throw new Error("Could not prevent default")}catch{var s=function(o,l){var c,d;return l=l||{},l.bubbles=!!l.bubbles,l.cancelable=!!l.cancelable,c=document.createEvent("CustomEvent"),c.initCustomEvent(o,l.bubbles,l.cancelable,l.detail),d=c.preventDefault,c.preventDefault=function(){d.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch{this.defaultPrevented=!0}},c};s.prototype=window.Event.prototype,window.CustomEvent=s}})();var ie=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Te(e,s){return s={exports:{}},e(s,s.exports),s.exports}(function(e){var s=function(){try{return!!Symbol.iterator}catch{return!1}},t=s(),o=function(w){var C={next:function(){var k=w.shift();return{done:k===void 0,value:k}}};return t&&(C[Symbol.iterator]=function(){return C}),C},l=function(w){return encodeURIComponent(w).replace(/%20/g,"+")},c=function(w){return decodeURIComponent(String(w).replace(/\+/g," "))},d=function(){var w=function(k){Object.defineProperty(this,"_entries",{writable:!0,value:{}});var x=typeof k;if(x!=="undefined")if(x==="string")k!==""&&this._fromString(k);else if(k instanceof w){var P=this;k.forEach(function(V,L){P.append(L,V)})}else if(k!==null&&x==="object")if(Object.prototype.toString.call(k)==="[object Array]")for(var $=0;$<k.length;$++){var N=k[$];if(Object.prototype.toString.call(N)==="[object Array]"||N.length!==2)this.append(N[0],N[1]);else throw new TypeError("Expected [string, any] as entry at index "+$+" of URLSearchParams's input")}else for(var q in k)k.hasOwnProperty(q)&&this.append(q,k[q]);else throw new TypeError("Unsupported input's type for URLSearchParams")},C=w.prototype;C.append=function(k,x){k in this._entries?this._entries[k].push(String(x)):this._entries[k]=[String(x)]},C.delete=function(k){delete this._entries[k]},C.get=function(k){return k in this._entries?this._entries[k][0]:null},C.getAll=function(k){return k in this._entries?this._entries[k].slice(0):[]},C.has=function(k){return k in this._entries},C.set=function(k,x){this._entries[k]=[String(x)]},C.forEach=function(k,x){var P;for(var $ in this._entries)if(this._entries.hasOwnProperty($)){P=this._entries[$];for(var N=0;N<P.length;N++)k.call(x,P[N],$,this)}},C.keys=function(){var k=[];return this.forEach(function(x,P){k.push(P)}),o(k)},C.values=function(){var k=[];return this.forEach(function(x){k.push(x)}),o(k)},C.entries=function(){var k=[];return this.forEach(function(x,P){k.push([P,x])}),o(k)},t&&(C[Symbol.iterator]=C.entries),C.toString=function(){var k=[];return this.forEach(function(x,P){k.push(l(P)+"="+l(x))}),k.join("&")},e.URLSearchParams=w},p=function(){try{var w=e.URLSearchParams;return new w("?a=1").toString()==="a=1"&&typeof w.prototype.set=="function"&&typeof w.prototype.entries=="function"}catch{return!1}};p()||d();var y=e.URLSearchParams.prototype;typeof y.sort!="function"&&(y.sort=function(){var w=this,C=[];this.forEach(function(x,P){C.push([P,x]),w._entries||w.delete(P)}),C.sort(function(x,P){return x[0]<P[0]?-1:x[0]>P[0]?1:0}),w._entries&&(w._entries={});for(var k=0;k<C.length;k++)this.append(C[k][0],C[k][1])}),typeof y._fromString!="function"&&Object.defineProperty(y,"_fromString",{enumerable:!1,configurable:!1,writable:!1,value:function(w){if(this._entries)this._entries={};else{var C=[];this.forEach(function($,N){C.push(N)});for(var k=0;k<C.length;k++)this.delete(C[k])}w=w.replace(/^\?/,"");for(var x=w.split("&"),P,k=0;k<x.length;k++)P=x[k].split("="),this.append(c(P[0]),P.length>1?c(P[1]):"")}})})(typeof ie<"u"?ie:typeof window<"u"?window:typeof self<"u"?self:ie),function(e){var s=function(){try{var l=new e.URL("b","http://a");return l.pathname="c d",l.href==="http://a/c%20d"&&l.searchParams}catch{return!1}},t=function(){var l=e.URL,c=function(y,w){typeof y!="string"&&(y=String(y)),w&&typeof w!="string"&&(w=String(w));var C=document,k;if(w&&(e.location===void 0||w!==e.location.href)){w=w.toLowerCase(),C=document.implementation.createHTMLDocument(""),k=C.createElement("base"),k.href=w,C.head.appendChild(k);try{if(k.href.indexOf(w)!==0)throw new Error(k.href)}catch(z){throw new Error("URL unable to set base "+w+" due to "+z)}}var x=C.createElement("a");x.href=y,k&&(C.body.appendChild(x),x.href=x.href);var P=C.createElement("input");if(P.type="url",P.value=y,x.protocol===":"||!/:/.test(x.href)||!P.checkValidity()&&!w)throw new TypeError("Invalid URL");Object.defineProperty(this,"_anchorElement",{value:x});var $=new e.URLSearchParams(this.search),N=!0,q=!0,V=this;["append","delete","set"].forEach(function(z){var Z=$[z];$[z]=function(){Z.apply($,arguments),N&&(q=!1,V.search=$.toString(),q=!0)}}),Object.defineProperty(this,"searchParams",{value:$,enumerable:!0});var L=void 0;Object.defineProperty(this,"_updateSearchParams",{enumerable:!1,configurable:!1,writable:!1,value:function(){this.search!==L&&(L=this.search,q&&(N=!1,this.searchParams._fromString(this.search),N=!0))}})},d=c.prototype,p=function(y){Object.defineProperty(d,y,{get:function(){return this._anchorElement[y]},set:function(w){this._anchorElement[y]=w},enumerable:!0})};["hash","host","hostname","port","protocol"].forEach(function(y){p(y)}),Object.defineProperty(d,"search",{get:function(){return this._anchorElement.search},set:function(y){this._anchorElement.search=y,this._updateSearchParams()},enumerable:!0}),Object.defineProperties(d,{toString:{get:function(){var y=this;return function(){return y.href}}},href:{get:function(){return this._anchorElement.href.replace(/\?$/,"")},set:function(y){this._anchorElement.href=y,this._updateSearchParams()},enumerable:!0},pathname:{get:function(){return this._anchorElement.pathname.replace(/(^\/?)/,"/")},set:function(y){this._anchorElement.pathname=y},enumerable:!0},origin:{get:function(){var y={"http:":80,"https:":443,"ftp:":21}[this._anchorElement.protocol],w=this._anchorElement.port!=y&&this._anchorElement.port!=="";return this._anchorElement.protocol+"//"+this._anchorElement.hostname+(w?":"+this._anchorElement.port:"")},enumerable:!0},password:{get:function(){return""},set:function(y){},enumerable:!0},username:{get:function(){return""},set:function(y){},enumerable:!0}}),c.createObjectURL=function(y){return l.createObjectURL.apply(l,arguments)},c.revokeObjectURL=function(y){return l.revokeObjectURL.apply(l,arguments)},e.URL=c};if(s()||t(),e.location!==void 0&&!("origin"in e.location)){var o=function(){return e.location.protocol+"//"+e.location.hostname+(e.location.port?":"+e.location.port:"")};try{Object.defineProperty(e.location,"origin",{get:o,enumerable:!0})}catch{setInterval(function(){e.location.origin=o()},100)}}}(typeof ie<"u"?ie:typeof window<"u"?window:typeof self<"u"?self:ie);function E(e,s,t){return s=pe(s),s in e?Object.defineProperty(e,s,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[s]=t,e}function ke(e,s){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var o=t.call(e,s||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(e)}function pe(e){var s=ke(e,"string");return typeof s=="symbol"?s:String(s)}function he(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}function oe(e,s){for(var t=0;t<s.length;t++){var o=s[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function yt(e,s,t){return s&&oe(e.prototype,s),t&&oe(e,t),e}function Ue(e,s,t){return s in e?Object.defineProperty(e,s,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[s]=t,e}function Pe(e,s){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);s&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),t.push.apply(t,o)}return t}function qe(e){for(var s=1;s<arguments.length;s++){var t=arguments[s]!=null?arguments[s]:{};s%2?Pe(Object(t),!0).forEach(function(o){Ue(e,o,t[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Pe(Object(t)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(t,o))})}return e}var ze={addCSS:!0,thumbWidth:15,watch:!0};function ot(e,s){return function(){return Array.from(document.querySelectorAll(s)).includes(this)}.call(e,s)}function ae(e,s){if(e&&s){var t=new Event(s,{bubbles:!0});e.dispatchEvent(t)}}var B=function(e){return e!=null?e.constructor:null},R=function(e,s){return!!(e&&s&&e instanceof s)},Je=function(e){return e==null},De=function(e){return B(e)===Object},Ze=function(e){return B(e)===Number&&!Number.isNaN(e)},Ve=function(e){return B(e)===String},K=function(e){return B(e)===Boolean},Oe=function(e){return B(e)===Function},X=function(e){return Array.isArray(e)},et=function(e){return R(e,NodeList)},ue=function(e){return R(e,Element)},be=function(e){return R(e,Event)},We=function(e){return Je(e)||(Ve(e)||X(e)||et(e))&&!e.length||De(e)&&!Object.keys(e).length},se={nullOrUndefined:Je,object:De,number:Ze,string:Ve,boolean:K,function:Oe,array:X,nodeList:et,element:ue,event:be,empty:We};function Ne(e){var s="".concat(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return s?Math.max(0,(s[1]?s[1].length:0)-(s[2]?+s[2]:0)):0}function xe(e,s){if(1>s){var t=Ne(s);return parseFloat(e.toFixed(t))}return Math.round(e/s)*s}var Mt=function(){function e(s,t){he(this,e),se.element(s)?this.element=s:se.string(s)&&(this.element=document.querySelector(s)),se.element(this.element)&&se.empty(this.element.rangeTouch)&&(this.config=qe({},ze,{},t),this.init())}return yt(e,[{key:"init",value:function(){e.enabled&&(this.config.addCSS&&(this.element.style.userSelect="none",this.element.style.webKitUserSelect="none",this.element.style.touchAction="manipulation"),this.listeners(!0),this.element.rangeTouch=this)}},{key:"destroy",value:function(){e.enabled&&(this.config.addCSS&&(this.element.style.userSelect="",this.element.style.webKitUserSelect="",this.element.style.touchAction=""),this.listeners(!1),this.element.rangeTouch=null)}},{key:"listeners",value:function(s){var t=this,o=s?"addEventListener":"removeEventListener";["touchstart","touchmove","touchend"].forEach(function(l){t.element[o](l,function(c){return t.set(c)},!1)})}},{key:"get",value:function(s){if(!e.enabled||!se.event(s))return null;var t,o=s.target,l=s.changedTouches[0],c=parseFloat(o.getAttribute("min"))||0,d=parseFloat(o.getAttribute("max"))||100,p=parseFloat(o.getAttribute("step"))||1,y=o.getBoundingClientRect(),w=100/y.width*(this.config.thumbWidth/2)/100;return 0>(t=100/y.width*(l.clientX-y.left))?t=0:100<t&&(t=100),50>t?t-=(100-2*t)*w:50<t&&(t+=2*(t-50)*w),c+xe(t/100*(d-c),p)}},{key:"set",value:function(s){e.enabled&&se.event(s)&&!s.target.disabled&&(s.preventDefault(),s.target.value=this.get(s),ae(s.target,s.type==="touchend"?"change":"input"))}}],[{key:"setup",value:function(s){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},o=null;if(se.empty(s)||se.string(s)?o=Array.from(document.querySelectorAll(se.string(s)?s:'input[type="range"]')):se.element(s)?o=[s]:se.nodeList(s)?o=Array.from(s):se.array(s)&&(o=s.filter(se.element)),se.empty(o))return null;var l=qe({},ze,{},t);if(se.string(s)&&l.watch){var c=new MutationObserver(function(d){Array.from(d).forEach(function(p){Array.from(p.addedNodes).forEach(function(y){se.element(y)&&ot(y,s)&&new e(y,l)})})});c.observe(document.body,{childList:!0,subtree:!0})}return o.map(function(d){return new e(d,t)})}},{key:"enabled",get:function(){return"ontouchstart"in document.documentElement}}]),e}();const je=e=>e!==null&&typeof e<"u"?e.constructor:null,we=(e,s)=>!!(e&&s&&e instanceof s),tt=e=>e===null||typeof e>"u",Se=e=>je(e)===Object,It=e=>je(e)===Number&&!Number.isNaN(e),de=e=>je(e)===String,Lt=e=>je(e)===Boolean,at=e=>typeof e=="function",lt=e=>Array.isArray(e),Dt=e=>we(e,WeakMap),bt=e=>we(e,NodeList),Ot=e=>je(e)===Text,Nt=e=>we(e,Event),_t=e=>we(e,KeyboardEvent),Rt=e=>we(e,window.TextTrackCue)||we(e,window.VTTCue),ge=e=>we(e,TextTrack)||!tt(e)&&de(e.kind),$t=e=>we(e,Promise)&&at(e.then),zt=e=>e!==null&&typeof e=="object"&&e.nodeType===1&&typeof e.style=="object"&&typeof e.ownerDocument=="object",Ye=e=>tt(e)||(de(e)||lt(e)||bt(e))&&!e.length||Se(e)&&!Object.keys(e).length;var u={nullOrUndefined:tt,object:Se,number:It,string:de,boolean:Lt,function:at,array:lt,weakMap:Dt,nodeList:bt,element:zt,textNode:Ot,event:Nt,keyboardEvent:_t,cue:Rt,track:ge,promise:$t,url:e=>{if(we(e,window.URL))return!0;if(!de(e))return!1;let s=e;(!e.startsWith("http://")||!e.startsWith("https://"))&&(s=`http://${e}`);try{return!Ye(new URL(s).hostname)}catch{return!1}},empty:Ye};const Ke=(()=>{const e=document.createElement("span"),s={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},t=Object.keys(s).find(o=>e.style[o]!==void 0);return u.string(t)?s[t]:!1})();function Xe(e,s){setTimeout(()=>{try{e.hidden=!0,e.offsetHeight,e.hidden=!1}catch{}},s)}const ht=!!window.document.documentMode,wt=/Edge/g.test(navigator.userAgent),Ft="WebkitAppearance"in document.documentElement.style&&!/Edge/g.test(navigator.userAgent),Ht=/iPhone|iPod/gi.test(navigator.userAgent)&&navigator.maxTouchPoints>1,vt=navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,ct=/iPad|iPhone|iPod/gi.test(navigator.userAgent)&&navigator.maxTouchPoints>1;var G={isIE:ht,isEdge:wt,isWebKit:Ft,isIPhone:Ht,isIPadOS:vt,isIos:ct};function Bt(e){return JSON.parse(JSON.stringify(e))}function Fe(e,s){return s.split(".").reduce((t,o)=>t&&t[o],e)}function j(e={},...s){if(!s.length)return e;const t=s.shift();return u.object(t)?(Object.keys(t).forEach(o=>{u.object(t[o])?(Object.keys(e).includes(o)||Object.assign(e,{[o]:{}}),j(e[o],t[o])):Object.assign(e,{[o]:t[o]})}),j(e,...s)):e}function Tt(e,s){const t=e.length?e:[e];Array.from(t).reverse().forEach((o,l)=>{const c=l>0?s.cloneNode(!0):s,d=o.parentNode,p=o.nextSibling;c.appendChild(o),p?d.insertBefore(c,p):d.appendChild(c)})}function Ce(e,s){!u.element(e)||u.empty(s)||Object.entries(s).filter(([,t])=>!u.nullOrUndefined(t)).forEach(([t,o])=>e.setAttribute(t,o))}function O(e,s,t){const o=document.createElement(e);return u.object(s)&&Ce(o,s),u.string(t)&&(o.innerText=t),o}function Ut(e,s){!u.element(e)||!u.element(s)||s.parentNode.insertBefore(e,s.nextSibling)}function ut(e,s,t,o){u.element(s)&&s.appendChild(O(e,t,o))}function Ae(e){if(u.nodeList(e)||u.array(e)){Array.from(e).forEach(Ae);return}!u.element(e)||!u.element(e.parentNode)||e.parentNode.removeChild(e)}function it(e){if(!u.element(e))return;let{length:s}=e.childNodes;for(;s>0;)e.removeChild(e.lastChild),s-=1}function st(e,s){return!u.element(s)||!u.element(s.parentNode)||!u.element(e)?null:(s.parentNode.replaceChild(e,s),e)}function ye(e,s){if(!u.string(e)||u.empty(e))return{};const t={},o=j({},s);return e.split(",").forEach(l=>{const c=l.trim(),d=c.replace(".",""),y=c.replace(/[[\]]/g,"").split("="),[w]=y,C=y.length>1?y[1].replace(/["']/g,""):"";switch(c.charAt(0)){case".":u.string(o.class)?t.class=`${o.class} ${d}`:t.class=d;break;case"#":t.id=c.replace("#","");break;case"[":t[w]=C;break}}),j(o,t)}function _e(e,s){if(!u.element(e))return;let t=s;u.boolean(t)||(t=!e.hidden),e.hidden=t}function F(e,s,t){if(u.nodeList(e))return Array.from(e).map(o=>F(o,s,t));if(u.element(e)){let o="toggle";return typeof t<"u"&&(o=t?"add":"remove"),e.classList[o](s),e.classList.contains(s)}return!1}function nt(e,s){return u.element(e)&&e.classList.contains(s)}function Re(e,s){const{prototype:t}=Element;function o(){return Array.from(document.querySelectorAll(s)).includes(this)}return(t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||o).call(e,s)}function kt(e,s){const{prototype:t}=Element;function o(){let c=this;do{if(Re.matches(c,s))return c;c=c.parentElement||c.parentNode}while(c!==null&&c.nodeType===1);return null}return(t.closest||o).call(e,s)}function Ge(e){return this.elements.container.querySelectorAll(e)}function ne(e){return this.elements.container.querySelector(e)}function rt(e=null,s=!1){u.element(e)&&e.focus({preventScroll:!0,focusVisible:s})}const xt={"audio/ogg":"vorbis","audio/wav":"1","video/webm":"vp8, vorbis","video/mp4":"avc1.42E01E, mp4a.40.2","video/ogg":"theora"},J={audio:"canPlayType"in document.createElement("audio"),video:"canPlayType"in document.createElement("video"),check(e,s){const t=J[e]||s!=="html5",o=t&&J.rangeInput;return{api:t,ui:o}},pip:G.isIPhone?!1:!!(u.function(O("video").webkitSetPresentationMode)||document.pictureInPictureEnabled&&!O("video").disablePictureInPicture),airplay:u.function(window.WebKitPlaybackTargetAvailabilityEvent),playsinline:"playsInline"in document.createElement("video"),mime(e){if(u.empty(e))return!1;const[s]=e.split("/");let t=e;if(!this.isHTML5||s!==this.type)return!1;Object.keys(xt).includes(t)&&(t+=`; codecs="${xt[e]}"`);try{return!!(t&&this.media.canPlayType(t).replace(/no/,""))}catch{return!1}},textTracks:"textTracks"in document.createElement("video"),rangeInput:(()=>{const e=document.createElement("input");return e.type="range",e.type==="range"})(),touch:"ontouchstart"in document.documentElement,transitions:Ke!==!1,reducedMotion:"matchMedia"in window&&window.matchMedia("(prefers-reduced-motion)").matches},St=(()=>{let e=!1;try{const s=Object.defineProperty({},"passive",{get(){return e=!0,null}});window.addEventListener("test",null,s),window.removeEventListener("test",null,s)}catch{}return e})();function Me(e,s,t,o=!1,l=!0,c=!1){if(!e||!("addEventListener"in e)||u.empty(s)||!u.function(t))return;const d=s.split(" ");let p=c;St&&(p={passive:l,capture:c}),d.forEach(y=>{this&&this.eventListeners&&o&&this.eventListeners.push({element:e,type:y,callback:t,options:p}),e[o?"addEventListener":"removeEventListener"](y,t,p)})}function A(e,s="",t,o=!0,l=!1){Me.call(this,e,s,t,!0,o,l)}function Qe(e,s="",t,o=!0,l=!1){Me.call(this,e,s,t,!1,o,l)}function He(e,s="",t,o=!0,l=!1){const c=(...d)=>{Qe(e,s,c,o,l),t.apply(this,d)};Me.call(this,e,s,c,!0,o,l)}function i(e,s="",t=!1,o={}){if(!u.element(e)||u.empty(s))return;const l=new CustomEvent(s,{bubbles:t,detail:{...o,plyr:this}});e.dispatchEvent(l)}function n(){this&&this.eventListeners&&(this.eventListeners.forEach(e=>{const{element:s,type:t,callback:o,options:l}=e;s.removeEventListener(t,o,l)}),this.eventListeners=[])}function a(){return new Promise(e=>this.ready?setTimeout(e,0):A.call(this,this.elements.container,"ready",e)).then(()=>{})}function r(e){u.promise(e)&&e.then(null,()=>{})}function h(e){return u.array(e)?e.filter((s,t)=>e.indexOf(s)===t):e}function f(e,s){return!u.array(e)||!e.length?null:e.reduce((t,o)=>Math.abs(o-s)<Math.abs(t-s)?o:t)}function m(e){return!window||!window.CSS?!1:window.CSS.supports(e)}const g=[[1,1],[4,3],[3,4],[5,4],[4,5],[3,2],[2,3],[16,10],[10,16],[16,9],[9,16],[21,9],[9,21],[32,9],[9,32]].reduce((e,[s,t])=>({...e,[s/t]:[s,t]}),{});function v(e){return!u.array(e)&&(!u.string(e)||!e.includes(":"))?!1:(u.array(e)?e:e.split(":")).map(Number).every(u.number)}function b(e){if(!u.array(e)||!e.every(u.number))return null;const[s,t]=e,o=(c,d)=>d===0?c:o(d,c%d),l=o(s,t);return[s/l,t/l]}function T(e){const s=o=>v(o)?o.split(":").map(Number):null;let t=s(e);if(t===null&&(t=s(this.config.ratio)),t===null&&!u.empty(this.embed)&&u.array(this.embed.ratio)&&({ratio:t}=this.embed),t===null&&this.isHTML5){const{videoWidth:o,videoHeight:l}=this.media;t=[o,l]}return b(t)}function S(e){if(!this.isVideo)return{};const{wrapper:s}=this.elements,t=T.call(this,e);if(!u.array(t))return{};const[o,l]=b(t),c=m(`aspect-ratio: ${o}/${l}`),d=100/o*l;if(c?s.style.aspectRatio=`${o}/${l}`:s.style.paddingBottom=`${d}%`,this.isVimeo&&!this.config.vimeo.premium&&this.supported.ui){const p=100/this.media.offsetWidth*parseInt(window.getComputedStyle(this.media).paddingBottom,10),y=(p-d)/(p/50);this.fullscreen.active?s.style.paddingBottom=null:this.media.style.transform=`translateY(-${y}%)`}else this.isHTML5&&s.classList.add(this.config.classNames.videoFixedRatio);return{padding:d,ratio:t}}function D(e,s,t=.05){const o=e/s,l=f(Object.keys(g),o);return Math.abs(l-o)<=t?g[l]:[e,s]}function I(){const e=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),s=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0);return[e,s]}const _={getSources(){return this.isHTML5?Array.from(this.media.querySelectorAll("source")).filter(s=>{const t=s.getAttribute("type");return u.empty(t)?!0:J.mime.call(this,t)}):[]},getQualityOptions(){return this.config.quality.forced?this.config.quality.options:_.getSources.call(this).map(e=>Number(e.getAttribute("size"))).filter(Boolean)},setup(){if(!this.isHTML5)return;const e=this;e.options.speed=e.config.speed.options,u.empty(this.config.ratio)||S.call(e),Object.defineProperty(e.media,"quality",{get(){const t=_.getSources.call(e).find(o=>o.getAttribute("src")===e.source);return t&&Number(t.getAttribute("size"))},set(s){if(e.quality!==s){if(e.config.quality.forced&&u.function(e.config.quality.onChange))e.config.quality.onChange(s);else{const o=_.getSources.call(e).find(w=>Number(w.getAttribute("size"))===s);if(!o)return;const{currentTime:l,paused:c,preload:d,readyState:p,playbackRate:y}=e.media;e.media.src=o.getAttribute("src"),(d!=="none"||p)&&(e.once("loadedmetadata",()=>{e.speed=y,e.currentTime=l,c||r(e.play())}),e.media.load())}i.call(e,e.media,"qualitychange",!1,{quality:s})}}})},cancelRequests(){this.isHTML5&&(Ae(_.getSources.call(this)),this.media.setAttribute("src",this.config.blankVideo),this.media.load(),this.debug.log("Cancelled network requests"))}};function U(e){return`${e}-${Math.floor(Math.random()*1e4)}`}function ee(e,...s){return u.empty(e)?e:e.toString().replace(/{(\d+)}/g,(t,o)=>s[o].toString())}function ce(e,s){return e===0||s===0||Number.isNaN(e)||Number.isNaN(s)?0:(e/s*100).toFixed(2)}const te=(e="",s="",t="")=>e.replace(new RegExp(s.toString().replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1"),"g"),t.toString()),Q=(e="")=>e.toString().replace(/\w\S*/g,s=>s.charAt(0).toUpperCase()+s.slice(1).toLowerCase());function le(e=""){let s=e.toString();return s=te(s,"-"," "),s=te(s,"_"," "),s=Q(s),te(s," ","")}function ve(e=""){let s=e.toString();return s=le(s),s.charAt(0).toLowerCase()+s.slice(1)}function Ie(e){const s=document.createDocumentFragment(),t=document.createElement("div");return s.appendChild(t),t.innerHTML=e,s.firstChild.innerText}function dt(e){const s=document.createElement("div");return s.appendChild(e),s.innerHTML}const ft={pip:"PIP",airplay:"AirPlay",html5:"HTML5",vimeo:"Vimeo",youtube:"YouTube"},re={get(e="",s={}){if(u.empty(e)||u.empty(s))return"";let t=Fe(s.i18n,e);if(u.empty(t))return Object.keys(ft).includes(e)?ft[e]:"";const o={"{seektime}":s.seekTime,"{title}":s.title};return Object.entries(o).forEach(([l,c])=>{t=te(t,l,c)}),t}};class Le{constructor(s){E(this,"get",t=>{if(!Le.supported||!this.enabled)return null;const o=window.localStorage.getItem(this.key);if(u.empty(o))return null;const l=JSON.parse(o);return u.string(t)&&t.length?l[t]:l}),E(this,"set",t=>{if(!Le.supported||!this.enabled||!u.object(t))return;let o=this.get();u.empty(o)&&(o={}),j(o,t);try{window.localStorage.setItem(this.key,JSON.stringify(o))}catch{}}),this.enabled=s.config.storage.enabled,this.key=s.config.storage.key}static get supported(){try{if(!("localStorage"in window))return!1;const s="___test";return window.localStorage.setItem(s,s),window.localStorage.removeItem(s),!0}catch{return!1}}}function $e(e,s="text"){return new Promise((t,o)=>{try{const l=new XMLHttpRequest;if(!("withCredentials"in l))return;l.addEventListener("load",()=>{if(s==="text")try{t(JSON.parse(l.responseText))}catch{t(l.responseText)}else t(l.response)}),l.addEventListener("error",()=>{throw new Error(l.status)}),l.open("GET",e,!0),l.responseType=s,l.send()}catch(l){o(l)}})}function Qt(e,s){if(!u.string(e))return;const t="cache",o=u.string(s);let l=!1;const c=()=>document.getElementById(s)!==null,d=(p,y)=>{p.innerHTML=y,!(o&&c())&&document.body.insertAdjacentElement("afterbegin",p)};if(!o||!c()){const p=Le.supported,y=document.createElement("div");if(y.setAttribute("hidden",""),o&&y.setAttribute("id",s),p){const w=window.localStorage.getItem(`${t}-${s}`);if(l=w!==null,l){const C=JSON.parse(w);d(y,C.content)}}$e(e).then(w=>{if(!u.empty(w)){if(p)try{window.localStorage.setItem(`${t}-${s}`,JSON.stringify({content:w}))}catch{}d(y,w)}}).catch(()=>{})}}const Jt=e=>Math.trunc(e/60/60%60,10),oi=e=>Math.trunc(e/60%60,10),ai=e=>Math.trunc(e%60,10);function Ct(e=0,s=!1,t=!1){if(!u.number(e))return Ct(void 0,s,t);const o=p=>`0${p}`.slice(-2);let l=Jt(e);const c=oi(e),d=ai(e);return s||l>0?l=`${l}:`:l="",`${t&&e>0?"-":""}${l}${o(c)}:${o(d)}`}const M={getIconUrl(){const e=new URL(this.config.iconUrl,window.location),s=window.location.host?window.location.host:window.top.location.host,t=e.host!==s||G.isIE&&!window.svg4everybody;return{url:this.config.iconUrl,cors:t}},findElements(){try{return this.elements.controls=ne.call(this,this.config.selectors.controls.wrapper),this.elements.buttons={play:Ge.call(this,this.config.selectors.buttons.play),pause:ne.call(this,this.config.selectors.buttons.pause),restart:ne.call(this,this.config.selectors.buttons.restart),rewind:ne.call(this,this.config.selectors.buttons.rewind),fastForward:ne.call(this,this.config.selectors.buttons.fastForward),mute:ne.call(this,this.config.selectors.buttons.mute),pip:ne.call(this,this.config.selectors.buttons.pip),airplay:ne.call(this,this.config.selectors.buttons.airplay),settings:ne.call(this,this.config.selectors.buttons.settings),captions:ne.call(this,this.config.selectors.buttons.captions),fullscreen:ne.call(this,this.config.selectors.buttons.fullscreen)},this.elements.progress=ne.call(this,this.config.selectors.progress),this.elements.inputs={seek:ne.call(this,this.config.selectors.inputs.seek),volume:ne.call(this,this.config.selectors.inputs.volume)},this.elements.display={buffer:ne.call(this,this.config.selectors.display.buffer),currentTime:ne.call(this,this.config.selectors.display.currentTime),duration:ne.call(this,this.config.selectors.display.duration)},u.element(this.elements.progress)&&(this.elements.display.seekTooltip=this.elements.progress.querySelector(`.${this.config.classNames.tooltip}`)),!0}catch(e){return this.debug.warn("It looks like there is a problem with your custom controls HTML",e),this.toggleNativeControls(!0),!1}},createIcon(e,s){const t="http://www.w3.org/2000/svg",o=M.getIconUrl.call(this),l=`${o.cors?"":o.url}#${this.config.iconPrefix}`,c=document.createElementNS(t,"svg");Ce(c,j(s,{"aria-hidden":"true",focusable:"false"}));const d=document.createElementNS(t,"use"),p=`${l}-${e}`;return"href"in d&&d.setAttributeNS("http://www.w3.org/1999/xlink","href",p),d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p),c.appendChild(d),c},createLabel(e,s={}){const t=re.get(e,this.config),o={...s,class:[s.class,this.config.classNames.hidden].filter(Boolean).join(" ")};return O("span",o,t)},createBadge(e){if(u.empty(e))return null;const s=O("span",{class:this.config.classNames.menu.value});return s.appendChild(O("span",{class:this.config.classNames.menu.badge},e)),s},createButton(e,s){const t=j({},s);let o=ve(e);const l={element:"button",toggle:!1,label:null,icon:null,labelPressed:null,iconPressed:null};switch(["element","icon","label"].forEach(d=>{Object.keys(t).includes(d)&&(l[d]=t[d],delete t[d])}),l.element==="button"&&!Object.keys(t).includes("type")&&(t.type="button"),Object.keys(t).includes("class")?t.class.split(" ").some(d=>d===this.config.classNames.control)||j(t,{class:`${t.class} ${this.config.classNames.control}`}):t.class=this.config.classNames.control,e){case"play":l.toggle=!0,l.label="play",l.labelPressed="pause",l.icon="play",l.iconPressed="pause";break;case"mute":l.toggle=!0,l.label="mute",l.labelPressed="unmute",l.icon="volume",l.iconPressed="muted";break;case"captions":l.toggle=!0,l.label="enableCaptions",l.labelPressed="disableCaptions",l.icon="captions-off",l.iconPressed="captions-on";break;case"fullscreen":l.toggle=!0,l.label="enterFullscreen",l.labelPressed="exitFullscreen",l.icon="enter-fullscreen",l.iconPressed="exit-fullscreen";break;case"play-large":t.class+=` ${this.config.classNames.control}--overlaid`,o="play",l.label="play",l.icon="play";break;default:u.empty(l.label)&&(l.label=o),u.empty(l.icon)&&(l.icon=e)}const c=O(l.element);return l.toggle?(c.appendChild(M.createIcon.call(this,l.iconPressed,{class:"icon--pressed"})),c.appendChild(M.createIcon.call(this,l.icon,{class:"icon--not-pressed"})),c.appendChild(M.createLabel.call(this,l.labelPressed,{class:"label--pressed"})),c.appendChild(M.createLabel.call(this,l.label,{class:"label--not-pressed"}))):(c.appendChild(M.createIcon.call(this,l.icon)),c.appendChild(M.createLabel.call(this,l.label))),j(t,ye(this.config.selectors.buttons[o],t)),Ce(c,t),o==="play"?(u.array(this.elements.buttons[o])||(this.elements.buttons[o]=[]),this.elements.buttons[o].push(c)):this.elements.buttons[o]=c,c},createRange(e,s){const t=O("input",j(ye(this.config.selectors.inputs[e]),{type:"range",min:0,max:100,step:.01,value:0,autocomplete:"off",role:"slider","aria-label":re.get(e,this.config),"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":0},s));return this.elements.inputs[e]=t,M.updateRangeFill.call(this,t),Mt.setup(t),t},createProgress(e,s){const t=O("progress",j(ye(this.config.selectors.display[e]),{min:0,max:100,value:0,role:"progressbar","aria-hidden":!0},s));if(e!=="volume"){t.appendChild(O("span",null,"0"));const o={played:"played",buffer:"buffered"}[e],l=o?re.get(o,this.config):"";t.innerText=`% ${l.toLowerCase()}`}return this.elements.display[e]=t,t},createTime(e,s){const t=ye(this.config.selectors.display[e],s),o=O("div",j(t,{class:`${t.class?t.class:""} ${this.config.classNames.display.time} `.trim(),"aria-label":re.get(e,this.config),role:"timer"}),"00:00");return this.elements.display[e]=o,o},bindMenuItemShortcuts(e,s){A.call(this,e,"keydown keyup",t=>{if(![" ","ArrowUp","ArrowDown","ArrowRight"].includes(t.key)||(t.preventDefault(),t.stopPropagation(),t.type==="keydown"))return;const o=Re(e,'[role="menuitemradio"]');if(!o&&[" ","ArrowRight"].includes(t.key))M.showMenuPanel.call(this,s,!0);else{let l;t.key!==" "&&(t.key==="ArrowDown"||o&&t.key==="ArrowRight"?(l=e.nextElementSibling,u.element(l)||(l=e.parentNode.firstElementChild)):(l=e.previousElementSibling,u.element(l)||(l=e.parentNode.lastElementChild)),rt.call(this,l,!0))}},!1),A.call(this,e,"keyup",t=>{t.key==="Return"&&M.focusFirstMenuItem.call(this,null,!0)})},createMenuItem({value:e,list:s,type:t,title:o,badge:l=null,checked:c=!1}){const d=ye(this.config.selectors.inputs[t]),p=O("button",j(d,{type:"button",role:"menuitemradio",class:`${this.config.classNames.control} ${d.class?d.class:""}`.trim(),"aria-checked":c,value:e})),y=O("span");y.innerHTML=o,u.element(l)&&y.appendChild(l),p.appendChild(y),Object.defineProperty(p,"checked",{enumerable:!0,get(){return p.getAttribute("aria-checked")==="true"},set(w){w&&Array.from(p.parentNode.children).filter(C=>Re(C,'[role="menuitemradio"]')).forEach(C=>C.setAttribute("aria-checked","false")),p.setAttribute("aria-checked",w?"true":"false")}}),this.listeners.bind(p,"click keyup",w=>{if(!(u.keyboardEvent(w)&&w.key!==" ")){switch(w.preventDefault(),w.stopPropagation(),p.checked=!0,t){case"language":this.currentTrack=Number(e);break;case"quality":this.quality=e;break;case"speed":this.speed=parseFloat(e);break}M.showMenuPanel.call(this,"home",u.keyboardEvent(w))}},t,!1),M.bindMenuItemShortcuts.call(this,p,t),s.appendChild(p)},formatTime(e=0,s=!1){if(!u.number(e))return e;const t=Jt(this.duration)>0;return Ct(e,t,s)},updateTimeDisplay(e=null,s=0,t=!1){!u.element(e)||!u.number(s)||(e.innerText=M.formatTime(s,t))},updateVolume(){this.supported.ui&&(u.element(this.elements.inputs.volume)&&M.setRange.call(this,this.elements.inputs.volume,this.muted?0:this.volume),u.element(this.elements.buttons.mute)&&(this.elements.buttons.mute.pressed=this.muted||this.volume===0))},setRange(e,s=0){u.element(e)&&(e.value=s,M.updateRangeFill.call(this,e))},updateProgress(e){if(!this.supported.ui||!u.event(e))return;let s=0;const t=(o,l)=>{const c=u.number(l)?l:0,d=u.element(o)?o:this.elements.display.buffer;if(u.element(d)){d.value=c;const p=d.getElementsByTagName("span")[0];u.element(p)&&(p.childNodes[0].nodeValue=c)}};if(e)switch(e.type){case"timeupdate":case"seeking":case"seeked":s=ce(this.currentTime,this.duration),e.type==="timeupdate"&&M.setRange.call(this,this.elements.inputs.seek,s);break;case"playing":case"progress":t(this.elements.display.buffer,this.buffered*100);break}},updateRangeFill(e){const s=u.event(e)?e.target:e;if(!(!u.element(s)||s.getAttribute("type")!=="range")){if(Re(s,this.config.selectors.inputs.seek)){s.setAttribute("aria-valuenow",this.currentTime);const t=M.formatTime(this.currentTime),o=M.formatTime(this.duration),l=re.get("seekLabel",this.config);s.setAttribute("aria-valuetext",l.replace("{currentTime}",t).replace("{duration}",o))}else if(Re(s,this.config.selectors.inputs.volume)){const t=s.value*100;s.setAttribute("aria-valuenow",t),s.setAttribute("aria-valuetext",`${t.toFixed(1)}%`)}else s.setAttribute("aria-valuenow",s.value);!G.isWebKit&&!G.isIPadOS||s.style.setProperty("--value",`${s.value/s.max*100}%`)}},updateSeekTooltip(e){var s,t;if(!this.config.tooltips.seek||!u.element(this.elements.inputs.seek)||!u.element(this.elements.display.seekTooltip)||this.duration===0)return;const o=this.elements.display.seekTooltip,l=`${this.config.classNames.tooltip}--visible`,c=C=>F(o,l,C);if(this.touch){c(!1);return}let d=0;const p=this.elements.progress.getBoundingClientRect();if(u.event(e))d=100/p.width*(e.pageX-p.left);else if(nt(o,l))d=parseFloat(o.style.left,10);else return;d<0?d=0:d>100&&(d=100);const y=this.duration/100*d;o.innerText=M.formatTime(y);const w=(s=this.config.markers)===null||s===void 0||(t=s.points)===null||t===void 0?void 0:t.find(({time:C})=>C===Math.round(y));w&&o.insertAdjacentHTML("afterbegin",`${w.label}<br>`),o.style.left=`${d}%`,u.event(e)&&["mouseenter","mouseleave"].includes(e.type)&&c(e.type==="mouseenter")},timeUpdate(e){const s=!u.element(this.elements.display.duration)&&this.config.invertTime;M.updateTimeDisplay.call(this,this.elements.display.currentTime,s?this.duration-this.currentTime:this.currentTime,s),!(e&&e.type==="timeupdate"&&this.media.seeking)&&M.updateProgress.call(this,e)},durationUpdate(){if(!this.supported.ui||!this.config.invertTime&&this.currentTime)return;if(this.duration>=2**32){_e(this.elements.display.currentTime,!0),_e(this.elements.progress,!0);return}u.element(this.elements.inputs.seek)&&this.elements.inputs.seek.setAttribute("aria-valuemax",this.duration);const e=u.element(this.elements.display.duration);!e&&this.config.displayDuration&&this.paused&&M.updateTimeDisplay.call(this,this.elements.display.currentTime,this.duration),e&&M.updateTimeDisplay.call(this,this.elements.display.duration,this.duration),this.config.markers.enabled&&M.setMarkers.call(this),M.updateSeekTooltip.call(this)},toggleMenuButton(e,s){_e(this.elements.settings.buttons[e],!s)},updateSetting(e,s,t){const o=this.elements.settings.panels[e];let l=null,c=s;if(e==="captions")l=this.currentTrack;else{if(l=u.empty(t)?this[e]:t,u.empty(l)&&(l=this.config[e].default),!u.empty(this.options[e])&&!this.options[e].includes(l)){this.debug.warn(`Unsupported value of '${l}' for ${e}`);return}if(!this.config[e].options.includes(l)){this.debug.warn(`Disabled value of '${l}' for ${e}`);return}}if(u.element(c)||(c=o&&o.querySelector('[role="menu"]')),!u.element(c))return;const d=this.elements.settings.buttons[e].querySelector(`.${this.config.classNames.menu.value}`);d.innerHTML=M.getLabel.call(this,e,l);const p=c&&c.querySelector(`[value="${l}"]`);u.element(p)&&(p.checked=!0)},getLabel(e,s){switch(e){case"speed":return s===1?re.get("normal",this.config):`${s}&times;`;case"quality":if(u.number(s)){const t=re.get(`qualityLabel.${s}`,this.config);return t.length?t:`${s}p`}return Q(s);case"captions":return H.getLabel.call(this);default:return null}},setQualityMenu(e){if(!u.element(this.elements.settings.panels.quality))return;const s="quality",t=this.elements.settings.panels.quality.querySelector('[role="menu"]');u.array(e)&&(this.options.quality=h(e).filter(c=>this.config.quality.options.includes(c)));const o=!u.empty(this.options.quality)&&this.options.quality.length>1;if(M.toggleMenuButton.call(this,s,o),it(t),M.checkMenu.call(this),!o)return;const l=c=>{const d=re.get(`qualityBadge.${c}`,this.config);return d.length?M.createBadge.call(this,d):null};this.options.quality.sort((c,d)=>{const p=this.config.quality.options;return p.indexOf(c)>p.indexOf(d)?1:-1}).forEach(c=>{M.createMenuItem.call(this,{value:c,list:t,type:s,title:M.getLabel.call(this,"quality",c),badge:l(c)})}),M.updateSetting.call(this,s,t)},setCaptionsMenu(){if(!u.element(this.elements.settings.panels.captions))return;const e="captions",s=this.elements.settings.panels.captions.querySelector('[role="menu"]'),t=H.getTracks.call(this),o=!!t.length;if(M.toggleMenuButton.call(this,e,o),it(s),M.checkMenu.call(this),!o)return;const l=t.map((c,d)=>({value:d,checked:this.captions.toggled&&this.currentTrack===d,title:H.getLabel.call(this,c),badge:c.language&&M.createBadge.call(this,c.language.toUpperCase()),list:s,type:"language"}));l.unshift({value:-1,checked:!this.captions.toggled,title:re.get("disabled",this.config),list:s,type:"language"}),l.forEach(M.createMenuItem.bind(this)),M.updateSetting.call(this,e,s)},setSpeedMenu(){if(!u.element(this.elements.settings.panels.speed))return;const e="speed",s=this.elements.settings.panels.speed.querySelector('[role="menu"]');this.options.speed=this.options.speed.filter(o=>o>=this.minimumSpeed&&o<=this.maximumSpeed);const t=!u.empty(this.options.speed)&&this.options.speed.length>1;M.toggleMenuButton.call(this,e,t),it(s),M.checkMenu.call(this),t&&(this.options.speed.forEach(o=>{M.createMenuItem.call(this,{value:o,list:s,type:e,title:M.getLabel.call(this,"speed",o)})}),M.updateSetting.call(this,e,s))},checkMenu(){const{buttons:e}=this.elements.settings,s=!u.empty(e)&&Object.values(e).some(t=>!t.hidden);_e(this.elements.settings.menu,!s)},focusFirstMenuItem(e,s=!1){if(this.elements.settings.popup.hidden)return;let t=e;u.element(t)||(t=Object.values(this.elements.settings.panels).find(l=>!l.hidden));const o=t.querySelector('[role^="menuitem"]');rt.call(this,o,s)},toggleMenu(e){const{popup:s}=this.elements.settings,t=this.elements.buttons.settings;if(!u.element(s)||!u.element(t))return;const{hidden:o}=s;let l=o;if(u.boolean(e))l=e;else if(u.keyboardEvent(e)&&e.key==="Escape")l=!1;else if(u.event(e)){const c=u.function(e.composedPath)?e.composedPath()[0]:e.target,d=s.contains(c);if(d||!d&&e.target!==t&&l)return}t.setAttribute("aria-expanded",l),_e(s,!l),F(this.elements.container,this.config.classNames.menu.open,l),l&&u.keyboardEvent(e)?M.focusFirstMenuItem.call(this,null,!0):!l&&!o&&rt.call(this,t,u.keyboardEvent(e))},getMenuSize(e){const s=e.cloneNode(!0);s.style.position="absolute",s.style.opacity=0,s.removeAttribute("hidden"),e.parentNode.appendChild(s);const t=s.scrollWidth,o=s.scrollHeight;return Ae(s),{width:t,height:o}},showMenuPanel(e="",s=!1){const t=this.elements.container.querySelector(`#plyr-settings-${this.id}-${e}`);if(!u.element(t))return;const o=t.parentNode,l=Array.from(o.children).find(c=>!c.hidden);if(J.transitions&&!J.reducedMotion){o.style.width=`${l.scrollWidth}px`,o.style.height=`${l.scrollHeight}px`;const c=M.getMenuSize.call(this,t),d=p=>{p.target!==o||!["width","height"].includes(p.propertyName)||(o.style.width="",o.style.height="",Qe.call(this,o,Ke,d))};A.call(this,o,Ke,d),o.style.width=`${c.width}px`,o.style.height=`${c.height}px`}_e(l,!0),_e(t,!1),M.focusFirstMenuItem.call(this,t,s)},setDownloadUrl(){const e=this.elements.buttons.download;u.element(e)&&e.setAttribute("href",this.download)},create(e){const{bindMenuItemShortcuts:s,createButton:t,createProgress:o,createRange:l,createTime:c,setQualityMenu:d,setSpeedMenu:p,showMenuPanel:y}=M;this.elements.controls=null,u.array(this.config.controls)&&this.config.controls.includes("play-large")&&this.elements.container.appendChild(t.call(this,"play-large"));const w=O("div",ye(this.config.selectors.controls.wrapper));this.elements.controls=w;const C={class:"plyr__controls__item"};return h(u.array(this.config.controls)?this.config.controls:[]).forEach(k=>{if(k==="restart"&&w.appendChild(t.call(this,"restart",C)),k==="rewind"&&w.appendChild(t.call(this,"rewind",C)),k==="play"&&w.appendChild(t.call(this,"play",C)),k==="fast-forward"&&w.appendChild(t.call(this,"fast-forward",C)),k==="progress"){const x=O("div",{class:`${C.class} plyr__progress__container`}),P=O("div",ye(this.config.selectors.progress));if(P.appendChild(l.call(this,"seek",{id:`plyr-seek-${e.id}`})),P.appendChild(o.call(this,"buffer")),this.config.tooltips.seek){const $=O("span",{class:this.config.classNames.tooltip},"00:00");P.appendChild($),this.elements.display.seekTooltip=$}this.elements.progress=P,x.appendChild(this.elements.progress),w.appendChild(x)}if(k==="current-time"&&w.appendChild(c.call(this,"currentTime",C)),k==="duration"&&w.appendChild(c.call(this,"duration",C)),k==="mute"||k==="volume"){let{volume:x}=this.elements;if((!u.element(x)||!w.contains(x))&&(x=O("div",j({},C,{class:`${C.class} plyr__volume`.trim()})),this.elements.volume=x,w.appendChild(x)),k==="mute"&&x.appendChild(t.call(this,"mute")),k==="volume"&&!G.isIos&&!G.isIPadOS){const P={max:1,step:.05,value:this.config.volume};x.appendChild(l.call(this,"volume",j(P,{id:`plyr-volume-${e.id}`})))}}if(k==="captions"&&w.appendChild(t.call(this,"captions",C)),k==="settings"&&!u.empty(this.config.settings)){const x=O("div",j({},C,{class:`${C.class} plyr__menu`.trim(),hidden:""}));x.appendChild(t.call(this,"settings",{"aria-haspopup":!0,"aria-controls":`plyr-settings-${e.id}`,"aria-expanded":!1}));const P=O("div",{class:"plyr__menu__container",id:`plyr-settings-${e.id}`,hidden:""}),$=O("div"),N=O("div",{id:`plyr-settings-${e.id}-home`}),q=O("div",{role:"menu"});N.appendChild(q),$.appendChild(N),this.elements.settings.panels.home=N,this.config.settings.forEach(V=>{const L=O("button",j(ye(this.config.selectors.buttons.settings),{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--forward`,role:"menuitem","aria-haspopup":!0,hidden:""}));s.call(this,L,V),A.call(this,L,"click",()=>{y.call(this,V,!1)});const z=O("span",null,re.get(V,this.config)),Z=O("span",{class:this.config.classNames.menu.value});Z.innerHTML=e[V],z.appendChild(Z),L.appendChild(z),q.appendChild(L);const fe=O("div",{id:`plyr-settings-${e.id}-${V}`,hidden:""}),me=O("button",{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--back`});me.appendChild(O("span",{"aria-hidden":!0},re.get(V,this.config))),me.appendChild(O("span",{class:this.config.classNames.hidden},re.get("menuBack",this.config))),A.call(this,fe,"keydown",W=>{W.key==="ArrowLeft"&&(W.preventDefault(),W.stopPropagation(),y.call(this,"home",!0))},!1),A.call(this,me,"click",()=>{y.call(this,"home",!1)}),fe.appendChild(me),fe.appendChild(O("div",{role:"menu"})),$.appendChild(fe),this.elements.settings.buttons[V]=L,this.elements.settings.panels[V]=fe}),P.appendChild($),x.appendChild(P),w.appendChild(x),this.elements.settings.popup=P,this.elements.settings.menu=x}if(k==="pip"&&J.pip&&w.appendChild(t.call(this,"pip",C)),k==="airplay"&&J.airplay&&w.appendChild(t.call(this,"airplay",C)),k==="download"){const x=j({},C,{element:"a",href:this.download,target:"_blank"});this.isHTML5&&(x.download="");const{download:P}=this.config.urls;!u.url(P)&&this.isEmbed&&j(x,{icon:`logo-${this.provider}`,label:this.provider}),w.appendChild(t.call(this,"download",x))}k==="fullscreen"&&w.appendChild(t.call(this,"fullscreen",C))}),this.isHTML5&&d.call(this,_.getQualityOptions.call(this)),p.call(this),w},inject(){if(this.config.loadSprite){const d=M.getIconUrl.call(this);d.cors&&Qt(d.url,"sprite-plyr")}this.id=Math.floor(Math.random()*1e4);let e=null;this.elements.controls=null;const s={id:this.id,seektime:this.config.seekTime,title:this.config.title};let t=!0;u.function(this.config.controls)&&(this.config.controls=this.config.controls.call(this,s)),this.config.controls||(this.config.controls=[]),u.element(this.config.controls)||u.string(this.config.controls)?e=this.config.controls:(e=M.create.call(this,{id:this.id,seektime:this.config.seekTime,speed:this.speed,quality:this.quality,captions:H.getLabel.call(this)}),t=!1);const o=d=>{let p=d;return Object.entries(s).forEach(([y,w])=>{p=te(p,`{${y}}`,w)}),p};t&&u.string(this.config.controls)&&(e=o(e));let l;u.string(this.config.selectors.controls.container)&&(l=document.querySelector(this.config.selectors.controls.container)),u.element(l)||(l=this.elements.container);const c=u.element(e)?"insertAdjacentElement":"insertAdjacentHTML";if(l[c]("afterbegin",e),u.element(this.elements.controls)||M.findElements.call(this),!u.empty(this.elements.buttons)){const d=p=>{const y=this.config.classNames.controlPressed;p.setAttribute("aria-pressed","false"),Object.defineProperty(p,"pressed",{configurable:!0,enumerable:!0,get(){return nt(p,y)},set(w=!1){F(p,y,w),p.setAttribute("aria-pressed",w?"true":"false")}})};Object.values(this.elements.buttons).filter(Boolean).forEach(p=>{u.array(p)||u.nodeList(p)?Array.from(p).filter(Boolean).forEach(d):d(p)})}if(G.isEdge&&Xe(l),this.config.tooltips.controls){const{classNames:d,selectors:p}=this.config,y=`${p.controls.wrapper} ${p.labels} .${d.hidden}`,w=Ge.call(this,y);Array.from(w).forEach(C=>{F(C,this.config.classNames.hidden,!1),F(C,this.config.classNames.tooltip,!0)})}},setMediaMetadata(){try{"mediaSession"in navigator&&(navigator.mediaSession.metadata=new window.MediaMetadata({title:this.config.mediaMetadata.title,artist:this.config.mediaMetadata.artist,album:this.config.mediaMetadata.album,artwork:this.config.mediaMetadata.artwork}))}catch{}},setMarkers(){var e,s;if(!this.duration||this.elements.markers)return;const t=(e=this.config.markers)===null||e===void 0||(s=e.points)===null||s===void 0?void 0:s.filter(({time:y})=>y>0&&y<this.duration);if(!(t!=null&&t.length))return;const o=document.createDocumentFragment(),l=document.createDocumentFragment();let c=null;const d=`${this.config.classNames.tooltip}--visible`,p=y=>F(c,d,y);t.forEach(y=>{const w=O("span",{class:this.config.classNames.marker},""),C=`${y.time/this.duration*100}%`;c&&(w.addEventListener("mouseenter",()=>{y.label||(c.style.left=C,c.innerHTML=y.label,p(!0))}),w.addEventListener("mouseleave",()=>{p(!1)})),w.addEventListener("click",()=>{this.currentTime=y.time}),w.style.left=C,l.appendChild(w)}),o.appendChild(l),this.config.tooltips.seek||(c=O("span",{class:this.config.classNames.tooltip},""),o.appendChild(c)),this.elements.markers={points:l,tip:c},this.elements.progress.appendChild(o)}};function Zt(e,s=!0){let t=e;if(s){const o=document.createElement("a");o.href=t,t=o.href}try{return new URL(t)}catch{return null}}function ei(e){const s=new URLSearchParams;return u.object(e)&&Object.entries(e).forEach(([t,o])=>{s.set(t,o)}),s}const H={setup(){if(!this.supported.ui)return;if(!this.isVideo||this.isYouTube||this.isHTML5&&!J.textTracks){u.array(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&M.setCaptionsMenu.call(this);return}if(u.element(this.elements.captions)||(this.elements.captions=O("div",ye(this.config.selectors.captions)),this.elements.captions.setAttribute("dir","auto"),Ut(this.elements.captions,this.elements.wrapper)),G.isIE&&window.URL){const l=this.media.querySelectorAll("track");Array.from(l).forEach(c=>{const d=c.getAttribute("src"),p=Zt(d);p!==null&&p.hostname!==window.location.href.hostname&&["http:","https:"].includes(p.protocol)&&$e(d,"blob").then(y=>{c.setAttribute("src",window.URL.createObjectURL(y))}).catch(()=>{Ae(c)})})}const e=navigator.languages||[navigator.language||navigator.userLanguage||"en"],s=h(e.map(l=>l.split("-")[0]));let t=(this.storage.get("language")||this.config.captions.language||"auto").toLowerCase();t==="auto"&&([t]=s);let o=this.storage.get("captions");if(u.boolean(o)||({active:o}=this.config.captions),Object.assign(this.captions,{toggled:!1,active:o,language:t,languages:s}),this.isHTML5){const l=this.config.captions.update?"addtrack removetrack":"removetrack";A.call(this,this.media.textTracks,l,H.update.bind(this))}setTimeout(H.update.bind(this),0)},update(){const e=H.getTracks.call(this,!0),{active:s,language:t,meta:o,currentTrackNode:l}=this.captions,c=!!e.find(d=>d.language===t);this.isHTML5&&this.isVideo&&e.filter(d=>!o.get(d)).forEach(d=>{this.debug.log("Track added",d),o.set(d,{default:d.mode==="showing"}),d.mode==="showing"&&(d.mode="hidden"),A.call(this,d,"cuechange",()=>H.updateCues.call(this))}),(c&&this.language!==t||!e.includes(l))&&(H.setLanguage.call(this,t),H.toggle.call(this,s&&c)),this.elements&&F(this.elements.container,this.config.classNames.captions.enabled,!u.empty(e)),u.array(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&M.setCaptionsMenu.call(this)},toggle(e,s=!0){if(!this.supported.ui)return;const{toggled:t}=this.captions,o=this.config.classNames.captions.active,l=u.nullOrUndefined(e)?!t:e;if(l!==t){if(s||(this.captions.active=l,this.storage.set({captions:l})),!this.language&&l&&!s){const c=H.getTracks.call(this),d=H.findTrack.call(this,[this.captions.language,...this.captions.languages],!0);this.captions.language=d.language,H.set.call(this,c.indexOf(d));return}this.elements.buttons.captions&&(this.elements.buttons.captions.pressed=l),F(this.elements.container,o,l),this.captions.toggled=l,M.updateSetting.call(this,"captions"),i.call(this,this.media,l?"captionsenabled":"captionsdisabled")}setTimeout(()=>{l&&this.captions.toggled&&(this.captions.currentTrackNode.mode="hidden")})},set(e,s=!0){const t=H.getTracks.call(this);if(e===-1){H.toggle.call(this,!1,s);return}if(!u.number(e)){this.debug.warn("Invalid caption argument",e);return}if(!(e in t)){this.debug.warn("Track not found",e);return}if(this.captions.currentTrack!==e){this.captions.currentTrack=e;const o=t[e],{language:l}=o||{};this.captions.currentTrackNode=o,M.updateSetting.call(this,"captions"),s||(this.captions.language=l,this.storage.set({language:l})),this.isVimeo&&this.embed.enableTextTrack(l),i.call(this,this.media,"languagechange")}H.toggle.call(this,!0,s),this.isHTML5&&this.isVideo&&H.updateCues.call(this)},setLanguage(e,s=!0){if(!u.string(e)){this.debug.warn("Invalid language argument",e);return}const t=e.toLowerCase();this.captions.language=t;const o=H.getTracks.call(this),l=H.findTrack.call(this,[t]);H.set.call(this,o.indexOf(l),s)},getTracks(e=!1){return Array.from((this.media||{}).textTracks||[]).filter(t=>!this.isHTML5||e||this.captions.meta.has(t)).filter(t=>["captions","subtitles"].includes(t.kind))},findTrack(e,s=!1){const t=H.getTracks.call(this),o=d=>Number((this.captions.meta.get(d)||{}).default),l=Array.from(t).sort((d,p)=>o(p)-o(d));let c;return e.every(d=>(c=l.find(p=>p.language===d),!c)),c||(s?l[0]:void 0)},getCurrentTrack(){return H.getTracks.call(this)[this.currentTrack]},getLabel(e){let s=e;return!u.track(s)&&J.textTracks&&this.captions.toggled&&(s=H.getCurrentTrack.call(this)),u.track(s)?u.empty(s.label)?u.empty(s.language)?re.get("enabled",this.config):e.language.toUpperCase():s.label:re.get("disabled",this.config)},updateCues(e){if(!this.supported.ui)return;if(!u.element(this.elements.captions)){this.debug.warn("No captions element to render to");return}if(!u.nullOrUndefined(e)&&!Array.isArray(e)){this.debug.warn("updateCues: Invalid input",e);return}let s=e;if(!s){const l=H.getCurrentTrack.call(this);s=Array.from((l||{}).activeCues||[]).map(c=>c.getCueAsHTML()).map(dt)}const t=s.map(l=>l.trim()).join(`
`);if(t!==this.elements.captions.innerHTML){it(this.elements.captions);const l=O("span",ye(this.config.selectors.caption));l.innerHTML=t,this.elements.captions.appendChild(l),i.call(this,this.media,"cuechange")}}},ti={enabled:!0,title:"",debug:!1,autoplay:!1,autopause:!0,playsinline:!0,seekTime:10,volume:1,muted:!1,duration:null,displayDuration:!0,invertTime:!0,toggleInvert:!0,ratio:null,clickToPlay:!0,hideControls:!0,resetOnEnd:!1,disableContextMenu:!0,loadSprite:!0,iconPrefix:"plyr",iconUrl:"https://cdn.plyr.io/3.7.8/plyr.svg",blankVideo:"https://cdn.plyr.io/static/blank.mp4",quality:{default:576,options:[4320,2880,2160,1440,1080,720,576,480,360,240],forced:!1,onChange:null},loop:{active:!1},speed:{selected:1,options:[.5,.75,1,1.25,1.5,1.75,2,4]},keyboard:{focused:!0,global:!1},tooltips:{controls:!1,seek:!0},captions:{active:!1,language:"auto",update:!1},fullscreen:{enabled:!0,fallback:!0,iosNative:!1},storage:{enabled:!0,key:"plyr"},controls:["play-large","play","progress","current-time","mute","volume","captions","settings","pip","airplay","fullscreen"],settings:["captions","quality","speed"],i18n:{restart:"Restart",rewind:"Rewind {seektime}s",play:"Play",pause:"Pause",fastForward:"Forward {seektime}s",seek:"Seek",seekLabel:"{currentTime} of {duration}",played:"Played",buffered:"Buffered",currentTime:"Current time",duration:"Duration",volume:"Volume",mute:"Mute",unmute:"Unmute",enableCaptions:"Enable captions",disableCaptions:"Disable captions",download:"Download",enterFullscreen:"Enter fullscreen",exitFullscreen:"Exit fullscreen",frameTitle:"Player for {title}",captions:"Captions",settings:"Settings",pip:"PIP",menuBack:"Go back to previous menu",speed:"Speed",normal:"Normal",quality:"Quality",loop:"Loop",start:"Start",end:"End",all:"All",reset:"Reset",disabled:"Disabled",enabled:"Enabled",advertisement:"Ad",qualityBadge:{2160:"4K",1440:"HD",1080:"HD",720:"HD",576:"SD",480:"SD"}},urls:{download:null,vimeo:{sdk:"https://player.vimeo.com/api/player.js",iframe:"https://player.vimeo.com/video/{0}?{1}",api:"https://vimeo.com/api/oembed.json?url={0}"},youtube:{sdk:"https://www.youtube.com/iframe_api",api:"https://noembed.com/embed?url=https://www.youtube.com/watch?v={0}"},googleIMA:{sdk:"https://imasdk.googleapis.com/js/sdkloader/ima3.js"}},listeners:{seek:null,play:null,pause:null,restart:null,rewind:null,fastForward:null,mute:null,volume:null,captions:null,download:null,fullscreen:null,pip:null,airplay:null,speed:null,quality:null,loop:null,language:null},events:["ended","progress","stalled","playing","waiting","canplay","canplaythrough","loadstart","loadeddata","loadedmetadata","timeupdate","volumechange","play","pause","error","seeking","seeked","emptied","ratechange","cuechange","download","enterfullscreen","exitfullscreen","captionsenabled","captionsdisabled","languagechange","controlshidden","controlsshown","ready","statechange","qualitychange","adsloaded","adscontentpause","adscontentresume","adstarted","adsmidpoint","adscomplete","adsallcomplete","adsimpression","adsclick"],selectors:{editable:"input, textarea, select, [contenteditable]",container:".plyr",controls:{container:null,wrapper:".plyr__controls"},labels:"[data-plyr]",buttons:{play:'[data-plyr="play"]',pause:'[data-plyr="pause"]',restart:'[data-plyr="restart"]',rewind:'[data-plyr="rewind"]',fastForward:'[data-plyr="fast-forward"]',mute:'[data-plyr="mute"]',captions:'[data-plyr="captions"]',download:'[data-plyr="download"]',fullscreen:'[data-plyr="fullscreen"]',pip:'[data-plyr="pip"]',airplay:'[data-plyr="airplay"]',settings:'[data-plyr="settings"]',loop:'[data-plyr="loop"]'},inputs:{seek:'[data-plyr="seek"]',volume:'[data-plyr="volume"]',speed:'[data-plyr="speed"]',language:'[data-plyr="language"]',quality:'[data-plyr="quality"]'},display:{currentTime:".plyr__time--current",duration:".plyr__time--duration",buffer:".plyr__progress__buffer",loop:".plyr__progress__loop",volume:".plyr__volume--display"},progress:".plyr__progress",captions:".plyr__captions",caption:".plyr__caption"},classNames:{type:"plyr--{0}",provider:"plyr--{0}",video:"plyr__video-wrapper",embed:"plyr__video-embed",videoFixedRatio:"plyr__video-wrapper--fixed-ratio",embedContainer:"plyr__video-embed__container",poster:"plyr__poster",posterEnabled:"plyr__poster-enabled",ads:"plyr__ads",control:"plyr__control",controlPressed:"plyr__control--pressed",playing:"plyr--playing",paused:"plyr--paused",stopped:"plyr--stopped",loading:"plyr--loading",hover:"plyr--hover",tooltip:"plyr__tooltip",cues:"plyr__cues",marker:"plyr__progress__marker",hidden:"plyr__sr-only",hideControls:"plyr--hide-controls",isTouch:"plyr--is-touch",uiSupported:"plyr--full-ui",noTransition:"plyr--no-transition",display:{time:"plyr__time"},menu:{value:"plyr__menu__value",badge:"plyr__badge",open:"plyr--menu-open"},captions:{enabled:"plyr--captions-enabled",active:"plyr--captions-active"},fullscreen:{enabled:"plyr--fullscreen-enabled",fallback:"plyr--fullscreen-fallback"},pip:{supported:"plyr--pip-supported",active:"plyr--pip-active"},airplay:{supported:"plyr--airplay-supported",active:"plyr--airplay-active"},previewThumbnails:{thumbContainer:"plyr__preview-thumb",thumbContainerShown:"plyr__preview-thumb--is-shown",imageContainer:"plyr__preview-thumb__image-container",timeContainer:"plyr__preview-thumb__time-container",scrubbingContainer:"plyr__preview-scrubbing",scrubbingContainerShown:"plyr__preview-scrubbing--is-shown"}},attributes:{embed:{provider:"data-plyr-provider",id:"data-plyr-embed-id",hash:"data-plyr-embed-hash"}},ads:{enabled:!1,publisherId:"",tagUrl:""},previewThumbnails:{enabled:!1,src:""},vimeo:{byline:!1,portrait:!1,title:!1,speed:!0,transparent:!1,customControls:!0,referrerPolicy:null,premium:!1},youtube:{rel:0,showinfo:0,iv_load_policy:3,modestbranding:1,customControls:!0,noCookie:!1},mediaMetadata:{title:"",artist:"",album:"",artwork:[]},markers:{enabled:!1,points:[]}},qt={active:"picture-in-picture",inactive:"inline"},Be={html5:"html5",youtube:"youtube",vimeo:"vimeo"},Vt={audio:"audio",video:"video"};function li(e){return/^(https?:\/\/)?(www\.)?(youtube\.com|youtube-nocookie\.com|youtu\.?be)\/.+$/.test(e)?Be.youtube:/^https?:\/\/player.vimeo.com\/video\/\d{0,9}(?=\b|\/)/.test(e)?Be.vimeo:null}const Wt=()=>{};class hi{constructor(s=!1){this.enabled=window.console&&s,this.enabled&&this.log("Debugging enabled")}get log(){return this.enabled?Function.prototype.bind.call(console.log,console):Wt}get warn(){return this.enabled?Function.prototype.bind.call(console.warn,console):Wt}get error(){return this.enabled?Function.prototype.bind.call(console.error,console):Wt}}class Ee{constructor(s){E(this,"onChange",()=>{if(!this.supported)return;const t=this.player.elements.buttons.fullscreen;u.element(t)&&(t.pressed=this.active);const o=this.target===this.player.media?this.target:this.player.elements.container;i.call(this.player,o,this.active?"enterfullscreen":"exitfullscreen",!0)}),E(this,"toggleFallback",(t=!1)=>{if(t?this.scrollPosition={x:window.scrollX??0,y:window.scrollY??0}:window.scrollTo(this.scrollPosition.x,this.scrollPosition.y),document.body.style.overflow=t?"hidden":"",F(this.target,this.player.config.classNames.fullscreen.fallback,t),G.isIos){let o=document.head.querySelector('meta[name="viewport"]');const l="viewport-fit=cover";o||(o=document.createElement("meta"),o.setAttribute("name","viewport"));const c=u.string(o.content)&&o.content.includes(l);t?(this.cleanupViewport=!c,c||(o.content+=`,${l}`)):this.cleanupViewport&&(o.content=o.content.split(",").filter(d=>d.trim()!==l).join(","))}this.onChange()}),E(this,"trapFocus",t=>{if(G.isIos||G.isIPadOS||!this.active||t.key!=="Tab")return;const o=document.activeElement,l=Ge.call(this.player,"a[href], button:not(:disabled), input:not(:disabled), [tabindex]"),[c]=l,d=l[l.length-1];o===d&&!t.shiftKey?(c.focus(),t.preventDefault()):o===c&&t.shiftKey&&(d.focus(),t.preventDefault())}),E(this,"update",()=>{if(this.supported){let t;this.forceFallback?t="Fallback (forced)":Ee.nativeSupported?t="Native":t="Fallback",this.player.debug.log(`${t} fullscreen enabled`)}else this.player.debug.log("Fullscreen not supported and fallback disabled");F(this.player.elements.container,this.player.config.classNames.fullscreen.enabled,this.supported)}),E(this,"enter",()=>{this.supported&&(G.isIos&&this.player.config.fullscreen.iosNative?this.player.isVimeo?this.player.embed.requestFullscreen():this.target.webkitEnterFullscreen():!Ee.nativeSupported||this.forceFallback?this.toggleFallback(!0):this.prefix?u.empty(this.prefix)||this.target[`${this.prefix}Request${this.property}`]():this.target.requestFullscreen({navigationUI:"hide"}))}),E(this,"exit",()=>{if(this.supported){if(G.isIos&&this.player.config.fullscreen.iosNative)this.player.isVimeo?this.player.embed.exitFullscreen():this.target.webkitEnterFullscreen(),r(this.player.play());else if(!Ee.nativeSupported||this.forceFallback)this.toggleFallback(!1);else if(!this.prefix)(document.cancelFullScreen||document.exitFullscreen).call(document);else if(!u.empty(this.prefix)){const t=this.prefix==="moz"?"Cancel":"Exit";document[`${this.prefix}${t}${this.property}`]()}}}),E(this,"toggle",()=>{this.active?this.exit():this.enter()}),this.player=s,this.prefix=Ee.prefix,this.property=Ee.property,this.scrollPosition={x:0,y:0},this.forceFallback=s.config.fullscreen.fallback==="force",this.player.elements.fullscreen=s.config.fullscreen.container&&kt(this.player.elements.container,s.config.fullscreen.container),A.call(this.player,document,this.prefix==="ms"?"MSFullscreenChange":`${this.prefix}fullscreenchange`,()=>{this.onChange()}),A.call(this.player,this.player.elements.container,"dblclick",t=>{u.element(this.player.elements.controls)&&this.player.elements.controls.contains(t.target)||this.player.listeners.proxy(t,this.toggle,"fullscreen")}),A.call(this,this.player.elements.container,"keydown",t=>this.trapFocus(t)),this.update()}static get nativeSupported(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}get useNative(){return Ee.nativeSupported&&!this.forceFallback}static get prefix(){if(u.function(document.exitFullscreen))return"";let s="";return["webkit","moz","ms"].some(o=>u.function(document[`${o}ExitFullscreen`])||u.function(document[`${o}CancelFullScreen`])?(s=o,!0):!1),s}static get property(){return this.prefix==="moz"?"FullScreen":"Fullscreen"}get supported(){return[this.player.config.fullscreen.enabled,this.player.isVideo,Ee.nativeSupported||this.player.config.fullscreen.fallback,!this.player.isYouTube||Ee.nativeSupported||!G.isIos||this.player.config.playsinline&&!this.player.config.fullscreen.iosNative].every(Boolean)}get active(){if(!this.supported)return!1;if(!Ee.nativeSupported||this.forceFallback)return nt(this.target,this.player.config.classNames.fullscreen.fallback);const s=this.prefix?this.target.getRootNode()[`${this.prefix}${this.property}Element`]:this.target.getRootNode().fullscreenElement;return s&&s.shadowRoot?s===this.target.getRootNode().host:s===this.target}get target(){return G.isIos&&this.player.config.fullscreen.iosNative?this.player.media:this.player.elements.fullscreen??this.player.elements.container}}function At(e,s=1){return new Promise((t,o)=>{const l=new Image,c=()=>{delete l.onload,delete l.onerror,(l.naturalWidth>=s?t:o)(l)};Object.assign(l,{onload:c,onerror:c,src:e})})}const Y={addStyleHook(){F(this.elements.container,this.config.selectors.container.replace(".",""),!0),F(this.elements.container,this.config.classNames.uiSupported,this.supported.ui)},toggleNativeControls(e=!1){e&&this.isHTML5?this.media.setAttribute("controls",""):this.media.removeAttribute("controls")},build(){if(this.listeners.media(),!this.supported.ui){this.debug.warn(`Basic support only for ${this.provider} ${this.type}`),Y.toggleNativeControls.call(this,!0);return}u.element(this.elements.controls)||(M.inject.call(this),this.listeners.controls()),Y.toggleNativeControls.call(this),this.isHTML5&&H.setup.call(this),this.volume=null,this.muted=null,this.loop=null,this.quality=null,this.speed=null,M.updateVolume.call(this),M.timeUpdate.call(this),M.durationUpdate.call(this),Y.checkPlaying.call(this),F(this.elements.container,this.config.classNames.pip.supported,J.pip&&this.isHTML5&&this.isVideo),F(this.elements.container,this.config.classNames.airplay.supported,J.airplay&&this.isHTML5),F(this.elements.container,this.config.classNames.isTouch,this.touch),this.ready=!0,setTimeout(()=>{i.call(this,this.media,"ready")},0),Y.setTitle.call(this),this.poster&&Y.setPoster.call(this,this.poster,!1).catch(()=>{}),this.config.duration&&M.durationUpdate.call(this),this.config.mediaMetadata&&M.setMediaMetadata.call(this)},setTitle(){let e=re.get("play",this.config);if(u.string(this.config.title)&&!u.empty(this.config.title)&&(e+=`, ${this.config.title}`),Array.from(this.elements.buttons.play||[]).forEach(s=>{s.setAttribute("aria-label",e)}),this.isEmbed){const s=ne.call(this,"iframe");if(!u.element(s))return;const t=u.empty(this.config.title)?"video":this.config.title,o=re.get("frameTitle",this.config);s.setAttribute("title",o.replace("{title}",t))}},togglePoster(e){F(this.elements.container,this.config.classNames.posterEnabled,e)},setPoster(e,s=!0){return s&&this.poster?Promise.reject(new Error("Poster already set")):(this.media.setAttribute("data-poster",e),this.elements.poster.removeAttribute("hidden"),a.call(this).then(()=>At(e)).catch(t=>{throw e===this.poster&&Y.togglePoster.call(this,!1),t}).then(()=>{if(e!==this.poster)throw new Error("setPoster cancelled by later call to setPoster")}).then(()=>(Object.assign(this.elements.poster.style,{backgroundImage:`url('${e}')`,backgroundSize:""}),Y.togglePoster.call(this,!0),e)))},checkPlaying(e){F(this.elements.container,this.config.classNames.playing,this.playing),F(this.elements.container,this.config.classNames.paused,this.paused),F(this.elements.container,this.config.classNames.stopped,this.stopped),Array.from(this.elements.buttons.play||[]).forEach(s=>{Object.assign(s,{pressed:this.playing}),s.setAttribute("aria-label",re.get(this.playing?"pause":"play",this.config))}),!(u.event(e)&&e.type==="timeupdate")&&Y.toggleControls.call(this)},checkLoading(e){this.loading=["stalled","waiting"].includes(e.type),clearTimeout(this.timers.loading),this.timers.loading=setTimeout(()=>{F(this.elements.container,this.config.classNames.loading,this.loading),Y.toggleControls.call(this)},this.loading?250:0)},toggleControls(e){const{controls:s}=this.elements;if(s&&this.config.hideControls){const t=this.touch&&this.lastSeekTime+2e3>Date.now();this.toggleControls(!!(e||this.loading||this.paused||s.pressed||s.hover||t))}},migrateStyles(){Object.values({...this.media.style}).filter(e=>!u.empty(e)&&u.string(e)&&e.startsWith("--plyr")).forEach(e=>{this.elements.container.style.setProperty(e,this.media.style.getPropertyValue(e)),this.media.style.removeProperty(e)}),u.empty(this.media.style)&&this.media.removeAttribute("style")}};class ci{constructor(s){E(this,"firstTouch",()=>{const{player:t}=this,{elements:o}=t;t.touch=!0,F(o.container,t.config.classNames.isTouch,!0)}),E(this,"global",(t=!0)=>{const{player:o}=this;o.config.keyboard.global&&Me.call(o,window,"keydown keyup",this.handleKey,t,!1),Me.call(o,document.body,"click",this.toggleMenu,t),He.call(o,document.body,"touchstart",this.firstTouch)}),E(this,"container",()=>{const{player:t}=this,{config:o,elements:l,timers:c}=t;!o.keyboard.global&&o.keyboard.focused&&A.call(t,l.container,"keydown keyup",this.handleKey,!1),A.call(t,l.container,"mousemove mouseleave touchstart touchmove enterfullscreen exitfullscreen",y=>{const{controls:w}=l;w&&y.type==="enterfullscreen"&&(w.pressed=!1,w.hover=!1);const C=["touchstart","touchmove","mousemove"].includes(y.type);let k=0;C&&(Y.toggleControls.call(t,!0),k=t.touch?3e3:2e3),clearTimeout(c.controls),c.controls=setTimeout(()=>Y.toggleControls.call(t,!1),k)});const d=()=>{if(!t.isVimeo||t.config.vimeo.premium)return;const y=l.wrapper,{active:w}=t.fullscreen,[C,k]=T.call(t),x=m(`aspect-ratio: ${C} / ${k}`);if(!w){x?(y.style.width=null,y.style.height=null):(y.style.maxWidth=null,y.style.margin=null);return}const[P,$]=I(),N=P/$>C/k;x?(y.style.width=N?"auto":"100%",y.style.height=N?"100%":"auto"):(y.style.maxWidth=N?`${$/k*C}px`:null,y.style.margin=N?"0 auto":null)},p=()=>{clearTimeout(c.resized),c.resized=setTimeout(d,50)};A.call(t,l.container,"enterfullscreen exitfullscreen",y=>{const{target:w}=t.fullscreen;if(w!==l.container||!t.isEmbed&&u.empty(t.config.ratio))return;d(),(y.type==="enterfullscreen"?A:Qe).call(t,window,"resize",p)})}),E(this,"media",()=>{const{player:t}=this,{elements:o}=t;if(A.call(t,t.media,"timeupdate seeking seeked",c=>M.timeUpdate.call(t,c)),A.call(t,t.media,"durationchange loadeddata loadedmetadata",c=>M.durationUpdate.call(t,c)),A.call(t,t.media,"ended",()=>{t.isHTML5&&t.isVideo&&t.config.resetOnEnd&&(t.restart(),t.pause())}),A.call(t,t.media,"progress playing seeking seeked",c=>M.updateProgress.call(t,c)),A.call(t,t.media,"volumechange",c=>M.updateVolume.call(t,c)),A.call(t,t.media,"playing play pause ended emptied timeupdate",c=>Y.checkPlaying.call(t,c)),A.call(t,t.media,"waiting canplay seeked playing",c=>Y.checkLoading.call(t,c)),t.supported.ui&&t.config.clickToPlay&&!t.isAudio){const c=ne.call(t,`.${t.config.classNames.video}`);if(!u.element(c))return;A.call(t,o.container,"click",d=>{![o.container,c].includes(d.target)&&!c.contains(d.target)||t.touch&&t.config.hideControls||(t.ended?(this.proxy(d,t.restart,"restart"),this.proxy(d,()=>{r(t.play())},"play")):this.proxy(d,()=>{r(t.togglePlay())},"play"))})}t.supported.ui&&t.config.disableContextMenu&&A.call(t,o.wrapper,"contextmenu",c=>{c.preventDefault()},!1),A.call(t,t.media,"volumechange",()=>{t.storage.set({volume:t.volume,muted:t.muted})}),A.call(t,t.media,"ratechange",()=>{M.updateSetting.call(t,"speed"),t.storage.set({speed:t.speed})}),A.call(t,t.media,"qualitychange",c=>{M.updateSetting.call(t,"quality",null,c.detail.quality)}),A.call(t,t.media,"ready qualitychange",()=>{M.setDownloadUrl.call(t)});const l=t.config.events.concat(["keyup","keydown"]).join(" ");A.call(t,t.media,l,c=>{let{detail:d={}}=c;c.type==="error"&&(d=t.media.error),i.call(t,o.container,c.type,!0,d)})}),E(this,"proxy",(t,o,l)=>{const{player:c}=this,d=c.config.listeners[l],p=u.function(d);let y=!0;p&&(y=d.call(c,t)),y!==!1&&u.function(o)&&o.call(c,t)}),E(this,"bind",(t,o,l,c,d=!0)=>{const{player:p}=this,y=p.config.listeners[c],w=u.function(y);A.call(p,t,o,C=>this.proxy(C,l,c),d&&!w)}),E(this,"controls",()=>{const{player:t}=this,{elements:o}=t,l=G.isIE?"change":"input";if(o.buttons.play&&Array.from(o.buttons.play).forEach(c=>{this.bind(c,"click",()=>{r(t.togglePlay())},"play")}),this.bind(o.buttons.restart,"click",t.restart,"restart"),this.bind(o.buttons.rewind,"click",()=>{t.lastSeekTime=Date.now(),t.rewind()},"rewind"),this.bind(o.buttons.fastForward,"click",()=>{t.lastSeekTime=Date.now(),t.forward()},"fastForward"),this.bind(o.buttons.mute,"click",()=>{t.muted=!t.muted},"mute"),this.bind(o.buttons.captions,"click",()=>t.toggleCaptions()),this.bind(o.buttons.download,"click",()=>{i.call(t,t.media,"download")},"download"),this.bind(o.buttons.fullscreen,"click",()=>{t.fullscreen.toggle()},"fullscreen"),this.bind(o.buttons.pip,"click",()=>{t.pip="toggle"},"pip"),this.bind(o.buttons.airplay,"click",t.airplay,"airplay"),this.bind(o.buttons.settings,"click",c=>{c.stopPropagation(),c.preventDefault(),M.toggleMenu.call(t,c)},null,!1),this.bind(o.buttons.settings,"keyup",c=>{if([" ","Enter"].includes(c.key)){if(c.key==="Enter"){M.focusFirstMenuItem.call(t,null,!0);return}c.preventDefault(),c.stopPropagation(),M.toggleMenu.call(t,c)}},null,!1),this.bind(o.settings.menu,"keydown",c=>{c.key==="Escape"&&M.toggleMenu.call(t,c)}),this.bind(o.inputs.seek,"mousedown mousemove",c=>{const d=o.progress.getBoundingClientRect(),p=100/d.width*(c.pageX-d.left);c.currentTarget.setAttribute("seek-value",p)}),this.bind(o.inputs.seek,"mousedown mouseup keydown keyup touchstart touchend",c=>{const d=c.currentTarget,p="play-on-seeked";if(u.keyboardEvent(c)&&!["ArrowLeft","ArrowRight"].includes(c.key))return;t.lastSeekTime=Date.now();const y=d.hasAttribute(p),w=["mouseup","touchend","keyup"].includes(c.type);y&&w?(d.removeAttribute(p),r(t.play())):!w&&t.playing&&(d.setAttribute(p,""),t.pause())}),G.isIos){const c=Ge.call(t,'input[type="range"]');Array.from(c).forEach(d=>this.bind(d,l,p=>Xe(p.target)))}this.bind(o.inputs.seek,l,c=>{const d=c.currentTarget;let p=d.getAttribute("seek-value");u.empty(p)&&(p=d.value),d.removeAttribute("seek-value"),t.currentTime=p/d.max*t.duration},"seek"),this.bind(o.progress,"mouseenter mouseleave mousemove",c=>M.updateSeekTooltip.call(t,c)),this.bind(o.progress,"mousemove touchmove",c=>{const{previewThumbnails:d}=t;d&&d.loaded&&d.startMove(c)}),this.bind(o.progress,"mouseleave touchend click",()=>{const{previewThumbnails:c}=t;c&&c.loaded&&c.endMove(!1,!0)}),this.bind(o.progress,"mousedown touchstart",c=>{const{previewThumbnails:d}=t;d&&d.loaded&&d.startScrubbing(c)}),this.bind(o.progress,"mouseup touchend",c=>{const{previewThumbnails:d}=t;d&&d.loaded&&d.endScrubbing(c)}),G.isWebKit&&Array.from(Ge.call(t,'input[type="range"]')).forEach(c=>{this.bind(c,"input",d=>M.updateRangeFill.call(t,d.target))}),t.config.toggleInvert&&!u.element(o.display.duration)&&this.bind(o.display.currentTime,"click",()=>{t.currentTime!==0&&(t.config.invertTime=!t.config.invertTime,M.timeUpdate.call(t))}),this.bind(o.inputs.volume,l,c=>{t.volume=c.target.value},"volume"),this.bind(o.controls,"mouseenter mouseleave",c=>{o.controls.hover=!t.touch&&c.type==="mouseenter"}),o.fullscreen&&Array.from(o.fullscreen.children).filter(c=>!c.contains(o.container)).forEach(c=>{this.bind(c,"mouseenter mouseleave",d=>{o.controls&&(o.controls.hover=!t.touch&&d.type==="mouseenter")})}),this.bind(o.controls,"mousedown mouseup touchstart touchend touchcancel",c=>{o.controls.pressed=["mousedown","touchstart"].includes(c.type)}),this.bind(o.controls,"focusin",()=>{const{config:c,timers:d}=t;F(o.controls,c.classNames.noTransition,!0),Y.toggleControls.call(t,!0),setTimeout(()=>{F(o.controls,c.classNames.noTransition,!1)},0);const p=this.touch?3e3:4e3;clearTimeout(d.controls),d.controls=setTimeout(()=>Y.toggleControls.call(t,!1),p)}),this.bind(o.inputs.volume,"wheel",c=>{const d=c.webkitDirectionInvertedFromDevice,[p,y]=[c.deltaX,-c.deltaY].map(k=>d?-k:k),w=Math.sign(Math.abs(p)>Math.abs(y)?p:y);t.increaseVolume(w/50);const{volume:C}=t.media;(w===1&&C<1||w===-1&&C>0)&&c.preventDefault()},"volume",!1)}),this.player=s,this.lastKey=null,this.focusTimer=null,this.lastKeyDown=null,this.handleKey=this.handleKey.bind(this),this.toggleMenu=this.toggleMenu.bind(this),this.firstTouch=this.firstTouch.bind(this)}handleKey(s){const{player:t}=this,{elements:o}=t,{key:l,type:c,altKey:d,ctrlKey:p,metaKey:y,shiftKey:w}=s,C=c==="keydown",k=C&&l===this.lastKey;if(d||p||y||w||!l)return;const x=P=>{t.currentTime=t.duration/10*P};if(C){const P=document.activeElement;if(u.element(P)){const{editable:N}=t.config.selectors,{seek:q}=o.inputs;if(P!==q&&Re(P,N)||s.key===" "&&Re(P,'button, [role^="menuitem"]'))return}switch([" ","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","0","1","2","3","4","5","6","7","8","9","c","f","k","l","m"].includes(l)&&(s.preventDefault(),s.stopPropagation()),l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":k||x(parseInt(l,10));break;case" ":case"k":k||r(t.togglePlay());break;case"ArrowUp":t.increaseVolume(.1);break;case"ArrowDown":t.decreaseVolume(.1);break;case"m":k||(t.muted=!t.muted);break;case"ArrowRight":t.forward();break;case"ArrowLeft":t.rewind();break;case"f":t.fullscreen.toggle();break;case"c":k||t.toggleCaptions();break;case"l":t.loop=!t.loop;break}l==="Escape"&&!t.fullscreen.usingNative&&t.fullscreen.active&&t.fullscreen.toggle(),this.lastKey=l}else this.lastKey=null}toggleMenu(s){M.toggleMenu.call(this.player,s)}}var ui=Te(function(e,s){(function(t,o){e.exports=o()})(ie,function(){var t=function(){},o={},l={},c={};function d(x,P){x=x.push?x:[x];var $=[],N=x.length,q=N,V,L,z,Z;for(V=function(fe,me){me.length&&$.push(fe),q--,q||P($)};N--;){if(L=x[N],z=l[L],z){V(L,z);continue}Z=c[L]=c[L]||[],Z.push(V)}}function p(x,P){if(x){var $=c[x];if(l[x]=P,!!$)for(;$.length;)$[0](x,P),$.splice(0,1)}}function y(x,P){x.call&&(x={success:x}),P.length?(x.error||t)(P):(x.success||t)(x)}function w(x,P,$,N){var q=document,V=$.async,L=($.numRetries||0)+1,z=$.before||t,Z=x.replace(/[\?|#].*$/,""),fe=x.replace(/^(css|img)!/,""),me,W;N=N||0,/(^css!|\.css$)/.test(Z)?(W=q.createElement("link"),W.rel="stylesheet",W.href=fe,me="hideFocus"in W,me&&W.relList&&(me=0,W.rel="preload",W.as="style")):/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(Z)?(W=q.createElement("img"),W.src=fe):(W=q.createElement("script"),W.src=x,W.async=V===void 0?!0:V),W.onload=W.onerror=W.onbeforeload=function(ri){var Pt=ri.type[0];if(me)try{W.sheet.cssText.length||(Pt="e")}catch(wi){wi.code!=18&&(Pt="e")}if(Pt=="e"){if(N+=1,N<L)return w(x,P,$,N)}else if(W.rel=="preload"&&W.as=="style")return W.rel="stylesheet";P(x,Pt,ri.defaultPrevented)},z(x,W)!==!1&&q.head.appendChild(W)}function C(x,P,$){x=x.push?x:[x];var N=x.length,q=N,V=[],L,z;for(L=function(Z,fe,me){if(fe=="e"&&V.push(Z),fe=="b")if(me)V.push(Z);else return;N--,N||P(V)},z=0;z<q;z++)w(x[z],L,$)}function k(x,P,$){var N,q;if(P&&P.trim&&(N=P),q=(N?$:P)||{},N){if(N in o)throw"LoadJS";o[N]=!0}function V(L,z){C(x,function(Z){y(q,Z),L&&y({success:L,error:z},Z),p(N,Z)},q)}if(q.returnPromise)return new Promise(V);V()}return k.ready=function(P,$){return d(P,function(N){y($,N)}),k},k.done=function(P){p(P,[])},k.reset=function(){o={},l={},c={}},k.isDefined=function(P){return P in o},k})});function Yt(e){return new Promise((s,t)=>{ui(e,{success:s,error:t})})}function di(e){if(u.empty(e))return null;if(u.number(Number(e)))return e;const s=/^.*(vimeo.com\/|video\/)(\d+).*/;return e.match(s)?RegExp.$2:e}function fi(e){const s=/^.*(vimeo.com\/|video\/)(\d+)(\?.*&*h=|\/)+([\d,a-f]+)/,t=e.match(s);return t&&t.length===5?t[4]:null}function mt(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,i.call(this,this.media,e?"play":"pause"))}const Kt={setup(){const e=this;F(e.elements.wrapper,e.config.classNames.embed,!0),e.options.speed=e.config.speed.options,S.call(e),u.object(window.Vimeo)?Kt.ready.call(e):Yt(e.config.urls.vimeo.sdk).then(()=>{Kt.ready.call(e)}).catch(s=>{e.debug.warn("Vimeo SDK (player.js) failed to load",s)})},ready(){const e=this,s=e.config.vimeo,{premium:t,referrerPolicy:o,...l}=s;let c=e.media.getAttribute("src"),d="";u.empty(c)?(c=e.media.getAttribute(e.config.attributes.embed.id),d=e.media.getAttribute(e.config.attributes.embed.hash)):d=fi(c);const p=d?{h:d}:{};t&&Object.assign(l,{controls:!1,sidedock:!1});const y=ei({loop:e.config.loop.active,autoplay:e.autoplay,muted:e.muted,gesture:"media",playsinline:e.config.playsinline,...p,...l}),w=di(c),C=O("iframe"),k=ee(e.config.urls.vimeo.iframe,w,y);if(C.setAttribute("src",k),C.setAttribute("allowfullscreen",""),C.setAttribute("allow",["autoplay","fullscreen","picture-in-picture","encrypted-media","accelerometer","gyroscope"].join("; ")),u.empty(o)||C.setAttribute("referrerPolicy",o),t||!s.customControls)C.setAttribute("data-poster",e.poster),e.media=st(C,e.media);else{const L=O("div",{class:e.config.classNames.embedContainer,"data-poster":e.poster});L.appendChild(C),e.media=st(L,e.media)}s.customControls||$e(ee(e.config.urls.vimeo.api,k)).then(L=>{u.empty(L)||!L.thumbnail_url||Y.setPoster.call(e,L.thumbnail_url).catch(()=>{})}),e.embed=new window.Vimeo.Player(C,{autopause:e.config.autopause,muted:e.muted}),e.media.paused=!0,e.media.currentTime=0,e.supported.ui&&e.embed.disableTextTrack(),e.media.play=()=>(mt.call(e,!0),e.embed.play()),e.media.pause=()=>(mt.call(e,!1),e.embed.pause()),e.media.stop=()=>{e.pause(),e.currentTime=0};let{currentTime:x}=e.media;Object.defineProperty(e.media,"currentTime",{get(){return x},set(L){const{embed:z,media:Z,paused:fe,volume:me}=e,W=fe&&!z.hasPlayed;Z.seeking=!0,i.call(e,Z,"seeking"),Promise.resolve(W&&z.setVolume(0)).then(()=>z.setCurrentTime(L)).then(()=>W&&z.pause()).then(()=>W&&z.setVolume(me)).catch(()=>{})}});let P=e.config.speed.selected;Object.defineProperty(e.media,"playbackRate",{get(){return P},set(L){e.embed.setPlaybackRate(L).then(()=>{P=L,i.call(e,e.media,"ratechange")}).catch(()=>{e.options.speed=[1]})}});let{volume:$}=e.config;Object.defineProperty(e.media,"volume",{get(){return $},set(L){e.embed.setVolume(L).then(()=>{$=L,i.call(e,e.media,"volumechange")})}});let{muted:N}=e.config;Object.defineProperty(e.media,"muted",{get(){return N},set(L){const z=u.boolean(L)?L:!1;e.embed.setMuted(z?!0:e.config.muted).then(()=>{N=z,i.call(e,e.media,"volumechange")})}});let{loop:q}=e.config;Object.defineProperty(e.media,"loop",{get(){return q},set(L){const z=u.boolean(L)?L:e.config.loop.active;e.embed.setLoop(z).then(()=>{q=z})}});let V;e.embed.getVideoUrl().then(L=>{V=L,M.setDownloadUrl.call(e)}).catch(L=>{this.debug.warn(L)}),Object.defineProperty(e.media,"currentSrc",{get(){return V}}),Object.defineProperty(e.media,"ended",{get(){return e.currentTime===e.duration}}),Promise.all([e.embed.getVideoWidth(),e.embed.getVideoHeight()]).then(L=>{const[z,Z]=L;e.embed.ratio=D(z,Z),S.call(this)}),e.embed.setAutopause(e.config.autopause).then(L=>{e.config.autopause=L}),e.embed.getVideoTitle().then(L=>{e.config.title=L,Y.setTitle.call(this)}),e.embed.getCurrentTime().then(L=>{x=L,i.call(e,e.media,"timeupdate")}),e.embed.getDuration().then(L=>{e.media.duration=L,i.call(e,e.media,"durationchange")}),e.embed.getTextTracks().then(L=>{e.media.textTracks=L,H.setup.call(e)}),e.embed.on("cuechange",({cues:L=[]})=>{const z=L.map(Z=>Ie(Z.text));H.updateCues.call(e,z)}),e.embed.on("loaded",()=>{e.embed.getPaused().then(L=>{mt.call(e,!L),L||i.call(e,e.media,"playing")}),u.element(e.embed.element)&&e.supported.ui&&e.embed.element.setAttribute("tabindex",-1)}),e.embed.on("bufferstart",()=>{i.call(e,e.media,"waiting")}),e.embed.on("bufferend",()=>{i.call(e,e.media,"playing")}),e.embed.on("play",()=>{mt.call(e,!0),i.call(e,e.media,"playing")}),e.embed.on("pause",()=>{mt.call(e,!1)}),e.embed.on("timeupdate",L=>{e.media.seeking=!1,x=L.seconds,i.call(e,e.media,"timeupdate")}),e.embed.on("progress",L=>{e.media.buffered=L.percent,i.call(e,e.media,"progress"),parseInt(L.percent,10)===1&&i.call(e,e.media,"canplaythrough"),e.embed.getDuration().then(z=>{z!==e.media.duration&&(e.media.duration=z,i.call(e,e.media,"durationchange"))})}),e.embed.on("seeked",()=>{e.media.seeking=!1,i.call(e,e.media,"seeked")}),e.embed.on("ended",()=>{e.media.paused=!0,i.call(e,e.media,"ended")}),e.embed.on("error",L=>{e.media.error=L,i.call(e,e.media,"error")}),s.customControls&&setTimeout(()=>Y.build.call(e),0)}};function mi(e){if(u.empty(e))return null;const s=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;return e.match(s)?RegExp.$2:e}function pt(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,i.call(this,this.media,e?"play":"pause"))}function pi(e){if(e.noCookie)return"https://www.youtube-nocookie.com";if(window.location.protocol==="http:")return"http://www.youtube.com"}const Et={setup(){if(F(this.elements.wrapper,this.config.classNames.embed,!0),u.object(window.YT)&&u.function(window.YT.Player))Et.ready.call(this);else{const e=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=()=>{u.function(e)&&e(),Et.ready.call(this)},Yt(this.config.urls.youtube.sdk).catch(s=>{this.debug.warn("YouTube API failed to load",s)})}},getTitle(e){const s=ee(this.config.urls.youtube.api,e);$e(s).then(t=>{if(u.object(t)){const{title:o,height:l,width:c}=t;this.config.title=o,Y.setTitle.call(this),this.embed.ratio=D(c,l)}S.call(this)}).catch(()=>{S.call(this)})},ready(){const e=this,s=e.config.youtube,t=e.media&&e.media.getAttribute("id");if(!u.empty(t)&&t.startsWith("youtube-"))return;let o=e.media.getAttribute("src");u.empty(o)&&(o=e.media.getAttribute(this.config.attributes.embed.id));const l=mi(o),c=U(e.provider),d=O("div",{id:c,"data-poster":s.customControls?e.poster:void 0});if(e.media=st(d,e.media),s.customControls){const p=y=>`https://i.ytimg.com/vi/${l}/${y}default.jpg`;At(p("maxres"),121).catch(()=>At(p("sd"),121)).catch(()=>At(p("hq"))).then(y=>Y.setPoster.call(e,y.src)).then(y=>{y.includes("maxres")||(e.elements.poster.style.backgroundSize="cover")}).catch(()=>{})}e.embed=new window.YT.Player(e.media,{videoId:l,host:pi(s),playerVars:j({},{autoplay:e.config.autoplay?1:0,hl:e.config.hl,controls:e.supported.ui&&s.customControls?0:1,disablekb:1,playsinline:e.config.playsinline&&!e.config.fullscreen.iosNative?1:0,cc_load_policy:e.captions.active?1:0,cc_lang_pref:e.config.captions.language,widget_referrer:window?window.location.href:null},s),events:{onError(p){if(!e.media.error){const y=p.data,w={2:"The request contains an invalid parameter value. For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.",5:"The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.",100:"The video requested was not found. This error occurs when a video has been removed (for any reason) or has been marked as private.",101:"The owner of the requested video does not allow it to be played in embedded players.",150:"The owner of the requested video does not allow it to be played in embedded players."}[y]||"An unknown error occurred";e.media.error={code:y,message:w},i.call(e,e.media,"error")}},onPlaybackRateChange(p){const y=p.target;e.media.playbackRate=y.getPlaybackRate(),i.call(e,e.media,"ratechange")},onReady(p){if(u.function(e.media.play))return;const y=p.target;Et.getTitle.call(e,l),e.media.play=()=>{pt.call(e,!0),y.playVideo()},e.media.pause=()=>{pt.call(e,!1),y.pauseVideo()},e.media.stop=()=>{y.stopVideo()},e.media.duration=y.getDuration(),e.media.paused=!0,e.media.currentTime=0,Object.defineProperty(e.media,"currentTime",{get(){return Number(y.getCurrentTime())},set(x){e.paused&&!e.embed.hasPlayed&&e.embed.mute(),e.media.seeking=!0,i.call(e,e.media,"seeking"),y.seekTo(x)}}),Object.defineProperty(e.media,"playbackRate",{get(){return y.getPlaybackRate()},set(x){y.setPlaybackRate(x)}});let{volume:w}=e.config;Object.defineProperty(e.media,"volume",{get(){return w},set(x){w=x,y.setVolume(w*100),i.call(e,e.media,"volumechange")}});let{muted:C}=e.config;Object.defineProperty(e.media,"muted",{get(){return C},set(x){const P=u.boolean(x)?x:C;C=P,y[P?"mute":"unMute"](),y.setVolume(w*100),i.call(e,e.media,"volumechange")}}),Object.defineProperty(e.media,"currentSrc",{get(){return y.getVideoUrl()}}),Object.defineProperty(e.media,"ended",{get(){return e.currentTime===e.duration}});const k=y.getAvailablePlaybackRates();e.options.speed=k.filter(x=>e.config.speed.options.includes(x)),e.supported.ui&&s.customControls&&e.media.setAttribute("tabindex",-1),i.call(e,e.media,"timeupdate"),i.call(e,e.media,"durationchange"),clearInterval(e.timers.buffering),e.timers.buffering=setInterval(()=>{e.media.buffered=y.getVideoLoadedFraction(),(e.media.lastBuffered===null||e.media.lastBuffered<e.media.buffered)&&i.call(e,e.media,"progress"),e.media.lastBuffered=e.media.buffered,e.media.buffered===1&&(clearInterval(e.timers.buffering),i.call(e,e.media,"canplaythrough"))},200),s.customControls&&setTimeout(()=>Y.build.call(e),50)},onStateChange(p){const y=p.target;switch(clearInterval(e.timers.playing),e.media.seeking&&[1,2].includes(p.data)&&(e.media.seeking=!1,i.call(e,e.media,"seeked")),p.data){case-1:i.call(e,e.media,"timeupdate"),e.media.buffered=y.getVideoLoadedFraction(),i.call(e,e.media,"progress");break;case 0:pt.call(e,!1),e.media.loop?(y.stopVideo(),y.playVideo()):i.call(e,e.media,"ended");break;case 1:s.customControls&&!e.config.autoplay&&e.media.paused&&!e.embed.hasPlayed?e.media.pause():(pt.call(e,!0),i.call(e,e.media,"playing"),e.timers.playing=setInterval(()=>{i.call(e,e.media,"timeupdate")},50),e.media.duration!==y.getDuration()&&(e.media.duration=y.getDuration(),i.call(e,e.media,"durationchange")));break;case 2:e.muted||e.embed.unMute(),pt.call(e,!1);break;case 3:i.call(e,e.media,"waiting");break}i.call(e,e.elements.container,"statechange",!1,{code:p.data})}}})}},ii={setup(){if(!this.media){this.debug.warn("No media element found!");return}F(this.elements.container,this.config.classNames.type.replace("{0}",this.type),!0),F(this.elements.container,this.config.classNames.provider.replace("{0}",this.provider),!0),this.isEmbed&&F(this.elements.container,this.config.classNames.type.replace("{0}","video"),!0),this.isVideo&&(this.elements.wrapper=O("div",{class:this.config.classNames.video}),Tt(this.media,this.elements.wrapper),this.elements.poster=O("div",{class:this.config.classNames.poster}),this.elements.wrapper.appendChild(this.elements.poster)),this.isHTML5?_.setup.call(this):this.isYouTube?Et.setup.call(this):this.isVimeo&&Kt.setup.call(this)}},gi=e=>{e.manager&&e.manager.destroy(),e.elements.displayContainer&&e.elements.displayContainer.destroy(),e.elements.container.remove()};class yi{constructor(s){E(this,"load",()=>{this.enabled&&(!u.object(window.google)||!u.object(window.google.ima)?Yt(this.player.config.urls.googleIMA.sdk).then(()=>{this.ready()}).catch(()=>{this.trigger("error",new Error("Google IMA SDK failed to load"))}):this.ready())}),E(this,"ready",()=>{this.enabled||gi(this),this.startSafetyTimer(12e3,"ready()"),this.managerPromise.then(()=>{this.clearSafetyTimer("onAdsManagerLoaded()")}),this.listeners(),this.setupIMA()}),E(this,"setupIMA",()=>{this.elements.container=O("div",{class:this.player.config.classNames.ads}),this.player.elements.container.appendChild(this.elements.container),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),google.ima.settings.setLocale(this.player.config.ads.language),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(this.player.config.playsinline),this.elements.displayContainer=new google.ima.AdDisplayContainer(this.elements.container,this.player.media),this.loader=new google.ima.AdsLoader(this.elements.displayContainer),this.loader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,t=>this.onAdsManagerLoaded(t),!1),this.loader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,t=>this.onAdError(t),!1),this.requestAds()}),E(this,"requestAds",()=>{const{container:t}=this.player.elements;try{const o=new google.ima.AdsRequest;o.adTagUrl=this.tagUrl,o.linearAdSlotWidth=t.offsetWidth,o.linearAdSlotHeight=t.offsetHeight,o.nonLinearAdSlotWidth=t.offsetWidth,o.nonLinearAdSlotHeight=t.offsetHeight,o.forceNonLinearFullSlot=!1,o.setAdWillPlayMuted(!this.player.muted),this.loader.requestAds(o)}catch(o){this.onAdError(o)}}),E(this,"pollCountdown",(t=!1)=>{if(!t){clearInterval(this.countdownTimer),this.elements.container.removeAttribute("data-badge-text");return}const o=()=>{const l=Ct(Math.max(this.manager.getRemainingTime(),0)),c=`${re.get("advertisement",this.player.config)} - ${l}`;this.elements.container.setAttribute("data-badge-text",c)};this.countdownTimer=setInterval(o,100)}),E(this,"onAdsManagerLoaded",t=>{if(!this.enabled)return;const o=new google.ima.AdsRenderingSettings;o.restoreCustomPlaybackStateOnAdBreakComplete=!0,o.enablePreloading=!0,this.manager=t.getAdsManager(this.player,o),this.cuePoints=this.manager.getCuePoints(),this.manager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,l=>this.onAdError(l)),Object.keys(google.ima.AdEvent.Type).forEach(l=>{this.manager.addEventListener(google.ima.AdEvent.Type[l],c=>this.onAdEvent(c))}),this.trigger("loaded")}),E(this,"addCuePoints",()=>{u.empty(this.cuePoints)||this.cuePoints.forEach(t=>{if(t!==0&&t!==-1&&t<this.player.duration){const o=this.player.elements.progress;if(u.element(o)){const l=100/this.player.duration*t,c=O("span",{class:this.player.config.classNames.cues});c.style.left=`${l.toString()}%`,o.appendChild(c)}}})}),E(this,"onAdEvent",t=>{const{container:o}=this.player.elements,l=t.getAd(),c=t.getAdData();switch((p=>{i.call(this.player,this.player.media,`ads${p.replace(/_/g,"").toLowerCase()}`)})(t.type),t.type){case google.ima.AdEvent.Type.LOADED:this.trigger("loaded"),this.pollCountdown(!0),l.isLinear()||(l.width=o.offsetWidth,l.height=o.offsetHeight);break;case google.ima.AdEvent.Type.STARTED:this.manager.setVolume(this.player.volume);break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:this.player.ended?this.loadAds():this.loader.contentComplete();break;case google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:this.pauseContent();break;case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:this.pollCountdown(),this.resumeContent();break;case google.ima.AdEvent.Type.LOG:c.adError&&this.player.debug.warn(`Non-fatal ad error: ${c.adError.getMessage()}`);break}}),E(this,"onAdError",t=>{this.cancel(),this.player.debug.warn("Ads error",t)}),E(this,"listeners",()=>{const{container:t}=this.player.elements;let o;this.player.on("canplay",()=>{this.addCuePoints()}),this.player.on("ended",()=>{this.loader.contentComplete()}),this.player.on("timeupdate",()=>{o=this.player.currentTime}),this.player.on("seeked",()=>{const l=this.player.currentTime;u.empty(this.cuePoints)||this.cuePoints.forEach((c,d)=>{o<c&&c<l&&(this.manager.discardAdBreak(),this.cuePoints.splice(d,1))})}),window.addEventListener("resize",()=>{this.manager&&this.manager.resize(t.offsetWidth,t.offsetHeight,google.ima.ViewMode.NORMAL)})}),E(this,"play",()=>{const{container:t}=this.player.elements;this.managerPromise||this.resumeContent(),this.managerPromise.then(()=>{this.manager.setVolume(this.player.volume),this.elements.displayContainer.initialize();try{this.initialized||(this.manager.init(t.offsetWidth,t.offsetHeight,google.ima.ViewMode.NORMAL),this.manager.start()),this.initialized=!0}catch(o){this.onAdError(o)}}).catch(()=>{})}),E(this,"resumeContent",()=>{this.elements.container.style.zIndex="",this.playing=!1,r(this.player.media.play())}),E(this,"pauseContent",()=>{this.elements.container.style.zIndex=3,this.playing=!0,this.player.media.pause()}),E(this,"cancel",()=>{this.initialized&&this.resumeContent(),this.trigger("error"),this.loadAds()}),E(this,"loadAds",()=>{this.managerPromise.then(()=>{this.manager&&this.manager.destroy(),this.managerPromise=new Promise(t=>{this.on("loaded",t),this.player.debug.log(this.manager)}),this.initialized=!1,this.requestAds()}).catch(()=>{})}),E(this,"trigger",(t,...o)=>{const l=this.events[t];u.array(l)&&l.forEach(c=>{u.function(c)&&c.apply(this,o)})}),E(this,"on",(t,o)=>(u.array(this.events[t])||(this.events[t]=[]),this.events[t].push(o),this)),E(this,"startSafetyTimer",(t,o)=>{this.player.debug.log(`Safety timer invoked from: ${o}`),this.safetyTimer=setTimeout(()=>{this.cancel(),this.clearSafetyTimer("startSafetyTimer()")},t)}),E(this,"clearSafetyTimer",t=>{u.nullOrUndefined(this.safetyTimer)||(this.player.debug.log(`Safety timer cleared from: ${t}`),clearTimeout(this.safetyTimer),this.safetyTimer=null)}),this.player=s,this.config=s.config.ads,this.playing=!1,this.initialized=!1,this.elements={container:null,displayContainer:null},this.manager=null,this.loader=null,this.cuePoints=null,this.events={},this.safetyTimer=null,this.countdownTimer=null,this.managerPromise=new Promise((t,o)=>{this.on("loaded",t),this.on("error",o)}),this.load()}get enabled(){const{config:s}=this;return this.player.isHTML5&&this.player.isVideo&&s.enabled&&(!u.empty(s.publisherId)||u.url(s.tagUrl))}get tagUrl(){const{config:s}=this;if(u.url(s.tagUrl))return s.tagUrl;const t={AV_PUBLISHERID:"58c25bb0073ef448b1087ad6",AV_CHANNELID:"5a0458dc28a06145e4519d21",AV_URL:window.location.hostname,cb:Date.now(),AV_WIDTH:640,AV_HEIGHT:480,AV_CDIM2:s.publisherId};return`https://go.aniview.com/api/adserver6/vast/?${ei(t)}`}}function si(e=0,s=0,t=255){return Math.min(Math.max(e,s),t)}const bi=e=>{const s=[];return e.split(/\r\n\r\n|\n\n|\r\r/).forEach(o=>{const l={};o.split(/\r\n|\n|\r/).forEach(d=>{if(u.number(l.startTime)){if(!u.empty(d.trim())&&u.empty(l.text)){const p=d.trim().split("#xywh=");[l.text]=p,p[1]&&([l.x,l.y,l.w,l.h]=p[1].split(","))}}else{const p=d.match(/([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})( ?--> ?)([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})/);p&&(l.startTime=Number(p[1]||0)*60*60+Number(p[2])*60+Number(p[3])+ +`0.${p[4]}`,l.endTime=Number(p[6]||0)*60*60+Number(p[7])*60+Number(p[8])+ +`0.${p[9]}`)}}),l.text&&s.push(l)}),s},ni=(e,s)=>{const t=s.width/s.height,o={};return e>t?(o.width=s.width,o.height=1/e*s.width):(o.height=s.height,o.width=e*s.height),o};class Xt{constructor(s){E(this,"load",()=>{this.player.elements.display.seekTooltip&&(this.player.elements.display.seekTooltip.hidden=this.enabled),this.enabled&&this.getThumbnails().then(()=>{this.enabled&&(this.render(),this.determineContainerAutoSizing(),this.listeners(),this.loaded=!0)})}),E(this,"getThumbnails",()=>new Promise(t=>{const{src:o}=this.player.config.previewThumbnails;if(u.empty(o))throw new Error("Missing previewThumbnails.src config attribute");const l=()=>{this.thumbnails.sort((c,d)=>c.height-d.height),this.player.debug.log("Preview thumbnails",this.thumbnails),t()};if(u.function(o))o(c=>{this.thumbnails=c,l()});else{const d=(u.string(o)?[o]:o).map(p=>this.getThumbnail(p));Promise.all(d).then(l)}})),E(this,"getThumbnail",t=>new Promise(o=>{$e(t).then(l=>{const c={frames:bi(l),height:null,urlPrefix:""};!c.frames[0].text.startsWith("/")&&!c.frames[0].text.startsWith("http://")&&!c.frames[0].text.startsWith("https://")&&(c.urlPrefix=t.substring(0,t.lastIndexOf("/")+1));const d=new Image;d.onload=()=>{c.height=d.naturalHeight,c.width=d.naturalWidth,this.thumbnails.push(c),o()},d.src=c.urlPrefix+c.frames[0].text})})),E(this,"startMove",t=>{if(this.loaded&&!(!u.event(t)||!["touchmove","mousemove"].includes(t.type))&&this.player.media.duration){if(t.type==="touchmove")this.seekTime=this.player.media.duration*(this.player.elements.inputs.seek.value/100);else{var o,l;const c=this.player.elements.progress.getBoundingClientRect(),d=100/c.width*(t.pageX-c.left);this.seekTime=this.player.media.duration*(d/100),this.seekTime<0&&(this.seekTime=0),this.seekTime>this.player.media.duration-1&&(this.seekTime=this.player.media.duration-1),this.mousePosX=t.pageX,this.elements.thumb.time.innerText=Ct(this.seekTime);const p=(o=this.player.config.markers)===null||o===void 0||(l=o.points)===null||l===void 0?void 0:l.find(({time:y})=>y===Math.round(this.seekTime));p&&this.elements.thumb.time.insertAdjacentHTML("afterbegin",`${p.label}<br>`)}this.showImageAtCurrentTime()}}),E(this,"endMove",()=>{this.toggleThumbContainer(!1,!0)}),E(this,"startScrubbing",t=>{(u.nullOrUndefined(t.button)||t.button===!1||t.button===0)&&(this.mouseDown=!0,this.player.media.duration&&(this.toggleScrubbingContainer(!0),this.toggleThumbContainer(!1,!0),this.showImageAtCurrentTime()))}),E(this,"endScrubbing",()=>{this.mouseDown=!1,Math.ceil(this.lastTime)===Math.ceil(this.player.media.currentTime)?this.toggleScrubbingContainer(!1):He.call(this.player,this.player.media,"timeupdate",()=>{this.mouseDown||this.toggleScrubbingContainer(!1)})}),E(this,"listeners",()=>{this.player.on("play",()=>{this.toggleThumbContainer(!1,!0)}),this.player.on("seeked",()=>{this.toggleThumbContainer(!1)}),this.player.on("timeupdate",()=>{this.lastTime=this.player.media.currentTime})}),E(this,"render",()=>{this.elements.thumb.container=O("div",{class:this.player.config.classNames.previewThumbnails.thumbContainer}),this.elements.thumb.imageContainer=O("div",{class:this.player.config.classNames.previewThumbnails.imageContainer}),this.elements.thumb.container.appendChild(this.elements.thumb.imageContainer);const t=O("div",{class:this.player.config.classNames.previewThumbnails.timeContainer});this.elements.thumb.time=O("span",{},"00:00"),t.appendChild(this.elements.thumb.time),this.elements.thumb.imageContainer.appendChild(t),u.element(this.player.elements.progress)&&this.player.elements.progress.appendChild(this.elements.thumb.container),this.elements.scrubbing.container=O("div",{class:this.player.config.classNames.previewThumbnails.scrubbingContainer}),this.player.elements.wrapper.appendChild(this.elements.scrubbing.container)}),E(this,"destroy",()=>{this.elements.thumb.container&&this.elements.thumb.container.remove(),this.elements.scrubbing.container&&this.elements.scrubbing.container.remove()}),E(this,"showImageAtCurrentTime",()=>{this.mouseDown?this.setScrubbingContainerSize():this.setThumbContainerSizeAndPos();const t=this.thumbnails[0].frames.findIndex(c=>this.seekTime>=c.startTime&&this.seekTime<=c.endTime),o=t>=0;let l=0;this.mouseDown||this.toggleThumbContainer(o),o&&(this.thumbnails.forEach((c,d)=>{this.loadedImages.includes(c.frames[t].text)&&(l=d)}),t!==this.showingThumb&&(this.showingThumb=t,this.loadImage(l)))}),E(this,"loadImage",(t=0)=>{const o=this.showingThumb,l=this.thumbnails[t],{urlPrefix:c}=l,d=l.frames[o],p=l.frames[o].text,y=c+p;if(!this.currentImageElement||this.currentImageElement.dataset.filename!==p){this.loadingImage&&this.usingSprites&&(this.loadingImage.onload=null);const w=new Image;w.src=y,w.dataset.index=o,w.dataset.filename=p,this.showingThumbFilename=p,this.player.debug.log(`Loading image: ${y}`),w.onload=()=>this.showImage(w,d,t,o,p,!0),this.loadingImage=w,this.removeOldImages(w)}else this.showImage(this.currentImageElement,d,t,o,p,!1),this.currentImageElement.dataset.index=o,this.removeOldImages(this.currentImageElement)}),E(this,"showImage",(t,o,l,c,d,p=!0)=>{this.player.debug.log(`Showing thumb: ${d}. num: ${c}. qual: ${l}. newimg: ${p}`),this.setImageSizeAndOffset(t,o),p&&(this.currentImageContainer.appendChild(t),this.currentImageElement=t,this.loadedImages.includes(d)||this.loadedImages.push(d)),this.preloadNearby(c,!0).then(this.preloadNearby(c,!1)).then(this.getHigherQuality(l,t,o,d))}),E(this,"removeOldImages",t=>{Array.from(this.currentImageContainer.children).forEach(o=>{if(o.tagName.toLowerCase()!=="img")return;const l=this.usingSprites?500:1e3;if(o.dataset.index!==t.dataset.index&&!o.dataset.deleting){o.dataset.deleting=!0;const{currentImageContainer:c}=this;setTimeout(()=>{c.removeChild(o),this.player.debug.log(`Removing thumb: ${o.dataset.filename}`)},l)}})}),E(this,"preloadNearby",(t,o=!0)=>new Promise(l=>{setTimeout(()=>{const c=this.thumbnails[0].frames[t].text;if(this.showingThumbFilename===c){let d;o?d=this.thumbnails[0].frames.slice(t):d=this.thumbnails[0].frames.slice(0,t).reverse();let p=!1;d.forEach(y=>{const w=y.text;if(w!==c&&!this.loadedImages.includes(w)){p=!0,this.player.debug.log(`Preloading thumb filename: ${w}`);const{urlPrefix:C}=this.thumbnails[0],k=C+w,x=new Image;x.src=k,x.onload=()=>{this.player.debug.log(`Preloaded thumb filename: ${w}`),this.loadedImages.includes(w)||this.loadedImages.push(w),l()}}}),p||l()}},300)})),E(this,"getHigherQuality",(t,o,l,c)=>{if(t<this.thumbnails.length-1){let d=o.naturalHeight;this.usingSprites&&(d=l.h),d<this.thumbContainerHeight&&setTimeout(()=>{this.showingThumbFilename===c&&(this.player.debug.log(`Showing higher quality thumb for: ${c}`),this.loadImage(t+1))},300)}}),E(this,"toggleThumbContainer",(t=!1,o=!1)=>{const l=this.player.config.classNames.previewThumbnails.thumbContainerShown;this.elements.thumb.container.classList.toggle(l,t),!t&&o&&(this.showingThumb=null,this.showingThumbFilename=null)}),E(this,"toggleScrubbingContainer",(t=!1)=>{const o=this.player.config.classNames.previewThumbnails.scrubbingContainerShown;this.elements.scrubbing.container.classList.toggle(o,t),t||(this.showingThumb=null,this.showingThumbFilename=null)}),E(this,"determineContainerAutoSizing",()=>{(this.elements.thumb.imageContainer.clientHeight>20||this.elements.thumb.imageContainer.clientWidth>20)&&(this.sizeSpecifiedInCSS=!0)}),E(this,"setThumbContainerSizeAndPos",()=>{const{imageContainer:t}=this.elements.thumb;if(this.sizeSpecifiedInCSS){if(t.clientHeight>20&&t.clientWidth<20){const o=Math.floor(t.clientHeight*this.thumbAspectRatio);t.style.width=`${o}px`}else if(t.clientHeight<20&&t.clientWidth>20){const o=Math.floor(t.clientWidth/this.thumbAspectRatio);t.style.height=`${o}px`}}else{const o=Math.floor(this.thumbContainerHeight*this.thumbAspectRatio);t.style.height=`${this.thumbContainerHeight}px`,t.style.width=`${o}px`}this.setThumbContainerPos()}),E(this,"setThumbContainerPos",()=>{const t=this.player.elements.progress.getBoundingClientRect(),o=this.player.elements.container.getBoundingClientRect(),{container:l}=this.elements.thumb,c=o.left-t.left+10,d=o.right-t.left-l.clientWidth-10,p=this.mousePosX-t.left-l.clientWidth/2,y=si(p,c,d);l.style.left=`${y}px`,l.style.setProperty("--preview-arrow-offset",`${p-y}px`)}),E(this,"setScrubbingContainerSize",()=>{const{width:t,height:o}=ni(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});this.elements.scrubbing.container.style.width=`${t}px`,this.elements.scrubbing.container.style.height=`${o}px`}),E(this,"setImageSizeAndOffset",(t,o)=>{if(!this.usingSprites)return;const l=this.thumbContainerHeight/o.h;t.style.height=`${t.naturalHeight*l}px`,t.style.width=`${t.naturalWidth*l}px`,t.style.left=`-${o.x*l}px`,t.style.top=`-${o.y*l}px`}),this.player=s,this.thumbnails=[],this.loaded=!1,this.lastMouseMoveTime=Date.now(),this.mouseDown=!1,this.loadedImages=[],this.elements={thumb:{},scrubbing:{}},this.load()}get enabled(){return this.player.isHTML5&&this.player.isVideo&&this.player.config.previewThumbnails.enabled}get currentImageContainer(){return this.mouseDown?this.elements.scrubbing.container:this.elements.thumb.imageContainer}get usingSprites(){return Object.keys(this.thumbnails[0].frames[0]).includes("w")}get thumbAspectRatio(){return this.usingSprites?this.thumbnails[0].frames[0].w/this.thumbnails[0].frames[0].h:this.thumbnails[0].width/this.thumbnails[0].height}get thumbContainerHeight(){if(this.mouseDown){const{height:s}=ni(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});return s}return this.sizeSpecifiedInCSS?this.elements.thumb.imageContainer.clientHeight:Math.floor(this.player.media.clientWidth/this.thumbAspectRatio/4)}get currentImageElement(){return this.mouseDown?this.currentScrubbingImageElement:this.currentThumbnailImageElement}set currentImageElement(s){this.mouseDown?this.currentScrubbingImageElement=s:this.currentThumbnailImageElement=s}}const Gt={insertElements(e,s){u.string(s)?ut(e,this.media,{src:s}):u.array(s)&&s.forEach(t=>{ut(e,this.media,t)})},change(e){if(!Fe(e,"sources.length")){this.debug.warn("Invalid source format");return}_.cancelRequests.call(this),this.destroy.call(this,()=>{this.options.quality=[],Ae(this.media),this.media=null,u.element(this.elements.container)&&this.elements.container.removeAttribute("class");const{sources:s,type:t}=e,[{provider:o=Be.html5,src:l}]=s,c=o==="html5"?t:"div",d=o==="html5"?{}:{src:l};Object.assign(this,{provider:o,type:t,supported:J.check(t,o,this.config.playsinline),media:O(c,d)}),this.elements.container.appendChild(this.media),u.boolean(e.autoplay)&&(this.config.autoplay=e.autoplay),this.isHTML5&&(this.config.crossorigin&&this.media.setAttribute("crossorigin",""),this.config.autoplay&&this.media.setAttribute("autoplay",""),u.empty(e.poster)||(this.poster=e.poster),this.config.loop.active&&this.media.setAttribute("loop",""),this.config.muted&&this.media.setAttribute("muted",""),this.config.playsinline&&this.media.setAttribute("playsinline","")),Y.addStyleHook.call(this),this.isHTML5&&Gt.insertElements.call(this,"source",s),this.config.title=e.title,ii.setup.call(this),this.isHTML5&&Object.keys(e).includes("tracks")&&Gt.insertElements.call(this,"track",e.tracks),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&Y.build.call(this),this.isHTML5&&this.media.load(),u.empty(e.previewThumbnails)||(Object.assign(this.config.previewThumbnails,e.previewThumbnails),this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new Xt(this))),this.fullscreen.update()},!0)}};class gt{constructor(s,t){if(E(this,"play",()=>u.function(this.media.play)?(this.ads&&this.ads.enabled&&this.ads.managerPromise.then(()=>this.ads.play()).catch(()=>r(this.media.play())),this.media.play()):null),E(this,"pause",()=>!this.playing||!u.function(this.media.pause)?null:this.media.pause()),E(this,"togglePlay",p=>(u.boolean(p)?p:!this.playing)?this.play():this.pause()),E(this,"stop",()=>{this.isHTML5?(this.pause(),this.restart()):u.function(this.media.stop)&&this.media.stop()}),E(this,"restart",()=>{this.currentTime=0}),E(this,"rewind",p=>{this.currentTime-=u.number(p)?p:this.config.seekTime}),E(this,"forward",p=>{this.currentTime+=u.number(p)?p:this.config.seekTime}),E(this,"increaseVolume",p=>{const y=this.media.muted?0:this.volume;this.volume=y+(u.number(p)?p:0)}),E(this,"decreaseVolume",p=>{this.increaseVolume(-p)}),E(this,"airplay",()=>{J.airplay&&this.media.webkitShowPlaybackTargetPicker()}),E(this,"toggleControls",p=>{if(this.supported.ui&&!this.isAudio){const y=nt(this.elements.container,this.config.classNames.hideControls),w=typeof p>"u"?void 0:!p,C=F(this.elements.container,this.config.classNames.hideControls,w);if(C&&u.array(this.config.controls)&&this.config.controls.includes("settings")&&!u.empty(this.config.settings)&&M.toggleMenu.call(this,!1),C!==y){const k=C?"controlshidden":"controlsshown";i.call(this,this.media,k)}return!C}return!1}),E(this,"on",(p,y)=>{A.call(this,this.elements.container,p,y)}),E(this,"once",(p,y)=>{He.call(this,this.elements.container,p,y)}),E(this,"off",(p,y)=>{Qe(this.elements.container,p,y)}),E(this,"destroy",(p,y=!1)=>{if(!this.ready)return;const w=()=>{document.body.style.overflow="",this.embed=null,y?(Object.keys(this.elements).length&&(Ae(this.elements.buttons.play),Ae(this.elements.captions),Ae(this.elements.controls),Ae(this.elements.wrapper),this.elements.buttons.play=null,this.elements.captions=null,this.elements.controls=null,this.elements.wrapper=null),u.function(p)&&p()):(n.call(this),_.cancelRequests.call(this),st(this.elements.original,this.elements.container),i.call(this,this.elements.original,"destroyed",!0),u.function(p)&&p.call(this.elements.original),this.ready=!1,setTimeout(()=>{this.elements=null,this.media=null},200))};this.stop(),clearTimeout(this.timers.loading),clearTimeout(this.timers.controls),clearTimeout(this.timers.resized),this.isHTML5?(Y.toggleNativeControls.call(this,!0),w()):this.isYouTube?(clearInterval(this.timers.buffering),clearInterval(this.timers.playing),this.embed!==null&&u.function(this.embed.destroy)&&this.embed.destroy(),w()):this.isVimeo&&(this.embed!==null&&this.embed.unload().then(w),setTimeout(w,200))}),E(this,"supports",p=>J.mime.call(this,p)),this.timers={},this.ready=!1,this.loading=!1,this.failed=!1,this.touch=J.touch,this.media=s,u.string(this.media)&&(this.media=document.querySelectorAll(this.media)),(window.jQuery&&this.media instanceof jQuery||u.nodeList(this.media)||u.array(this.media))&&(this.media=this.media[0]),this.config=j({},ti,gt.defaults,t||{},(()=>{try{return JSON.parse(this.media.getAttribute("data-plyr-config"))}catch{return{}}})()),this.elements={container:null,fullscreen:null,captions:null,buttons:{},display:{},progress:{},inputs:{},settings:{popup:null,menu:null,panels:{},buttons:{}}},this.captions={active:null,currentTrack:-1,meta:new WeakMap},this.fullscreen={active:!1},this.options={speed:[],quality:[]},this.debug=new hi(this.config.debug),this.debug.log("Config",this.config),this.debug.log("Support",J),u.nullOrUndefined(this.media)||!u.element(this.media)){this.debug.error("Setup failed: no suitable element passed");return}if(this.media.plyr){this.debug.warn("Target already setup");return}if(!this.config.enabled){this.debug.error("Setup failed: disabled by config");return}if(!J.check().api){this.debug.error("Setup failed: no support");return}const o=this.media.cloneNode(!0);o.autoplay=!1,this.elements.original=o;const l=this.media.tagName.toLowerCase();let c=null,d=null;switch(l){case"div":if(c=this.media.querySelector("iframe"),u.element(c)){if(d=Zt(c.getAttribute("src")),this.provider=li(d.toString()),this.elements.container=this.media,this.media=c,this.elements.container.className="",d.search.length){const p=["1","true"];p.includes(d.searchParams.get("autoplay"))&&(this.config.autoplay=!0),p.includes(d.searchParams.get("loop"))&&(this.config.loop.active=!0),this.isYouTube?(this.config.playsinline=p.includes(d.searchParams.get("playsinline")),this.config.youtube.hl=d.searchParams.get("hl")):this.config.playsinline=!0}}else this.provider=this.media.getAttribute(this.config.attributes.embed.provider),this.media.removeAttribute(this.config.attributes.embed.provider);if(u.empty(this.provider)||!Object.values(Be).includes(this.provider)){this.debug.error("Setup failed: Invalid provider");return}this.type=Vt.video;break;case"video":case"audio":this.type=l,this.provider=Be.html5,this.media.hasAttribute("crossorigin")&&(this.config.crossorigin=!0),this.media.hasAttribute("autoplay")&&(this.config.autoplay=!0),(this.media.hasAttribute("playsinline")||this.media.hasAttribute("webkit-playsinline"))&&(this.config.playsinline=!0),this.media.hasAttribute("muted")&&(this.config.muted=!0),this.media.hasAttribute("loop")&&(this.config.loop.active=!0);break;default:this.debug.error("Setup failed: unsupported type");return}if(this.supported=J.check(this.type,this.provider),!this.supported.api){this.debug.error("Setup failed: no support");return}this.eventListeners=[],this.listeners=new ci(this),this.storage=new Le(this),this.media.plyr=this,u.element(this.elements.container)||(this.elements.container=O("div"),Tt(this.media,this.elements.container)),Y.migrateStyles.call(this),Y.addStyleHook.call(this),ii.setup.call(this),this.config.debug&&A.call(this,this.elements.container,this.config.events.join(" "),p=>{this.debug.log(`event: ${p.type}`)}),this.fullscreen=new Ee(this),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&Y.build.call(this),this.listeners.container(),this.listeners.global(),this.config.ads.enabled&&(this.ads=new yi(this)),this.isHTML5&&this.config.autoplay&&this.once("canplay",()=>r(this.play())),this.lastSeekTime=0,this.config.previewThumbnails.enabled&&(this.previewThumbnails=new Xt(this))}get isHTML5(){return this.provider===Be.html5}get isEmbed(){return this.isYouTube||this.isVimeo}get isYouTube(){return this.provider===Be.youtube}get isVimeo(){return this.provider===Be.vimeo}get isVideo(){return this.type===Vt.video}get isAudio(){return this.type===Vt.audio}get playing(){return!!(this.ready&&!this.paused&&!this.ended)}get paused(){return!!this.media.paused}get stopped(){return!!(this.paused&&this.currentTime===0)}get ended(){return!!this.media.ended}set currentTime(s){if(!this.duration)return;const t=u.number(s)&&s>0;this.media.currentTime=t?Math.min(s,this.duration):0,this.debug.log(`Seeking to ${this.currentTime} seconds`)}get currentTime(){return Number(this.media.currentTime)}get buffered(){const{buffered:s}=this.media;return u.number(s)?s:s&&s.length&&this.duration>0?s.end(0)/this.duration:0}get seeking(){return!!this.media.seeking}get duration(){const s=parseFloat(this.config.duration),t=(this.media||{}).duration,o=!u.number(t)||t===1/0?0:t;return s||o}set volume(s){let t=s;const o=1,l=0;u.string(t)&&(t=Number(t)),u.number(t)||(t=this.storage.get("volume")),u.number(t)||({volume:t}=this.config),t>o&&(t=o),t<l&&(t=l),this.config.volume=t,this.media.volume=t,!u.empty(s)&&this.muted&&t>0&&(this.muted=!1)}get volume(){return Number(this.media.volume)}set muted(s){let t=s;u.boolean(t)||(t=this.storage.get("muted")),u.boolean(t)||(t=this.config.muted),this.config.muted=t,this.media.muted=t}get muted(){return!!this.media.muted}get hasAudio(){return!this.isHTML5||this.isAudio?!0:!!this.media.mozHasAudio||!!this.media.webkitAudioDecodedByteCount||!!(this.media.audioTracks&&this.media.audioTracks.length)}set speed(s){let t=null;u.number(s)&&(t=s),u.number(t)||(t=this.storage.get("speed")),u.number(t)||(t=this.config.speed.selected);const{minimumSpeed:o,maximumSpeed:l}=this;t=si(t,o,l),this.config.speed.selected=t,setTimeout(()=>{this.media&&(this.media.playbackRate=t)},0)}get speed(){return Number(this.media.playbackRate)}get minimumSpeed(){return this.isYouTube?Math.min(...this.options.speed):this.isVimeo?.5:.0625}get maximumSpeed(){return this.isYouTube?Math.max(...this.options.speed):this.isVimeo?2:16}set quality(s){const t=this.config.quality,o=this.options.quality;if(!o.length)return;let l=[!u.empty(s)&&Number(s),this.storage.get("quality"),t.selected,t.default].find(u.number),c=!0;if(!o.includes(l)){const d=f(o,l);this.debug.warn(`Unsupported quality option: ${l}, using ${d} instead`),l=d,c=!1}t.selected=l,this.media.quality=l,c&&this.storage.set({quality:l})}get quality(){return this.media.quality}set loop(s){const t=u.boolean(s)?s:this.config.loop.active;this.config.loop.active=t,this.media.loop=t}get loop(){return!!this.media.loop}set source(s){Gt.change.call(this,s)}get source(){return this.media.currentSrc}get download(){const{download:s}=this.config.urls;return u.url(s)?s:this.source}set download(s){u.url(s)&&(this.config.urls.download=s,M.setDownloadUrl.call(this))}set poster(s){if(!this.isVideo){this.debug.warn("Poster can only be set for video");return}Y.setPoster.call(this,s,!1).catch(()=>{})}get poster(){return this.isVideo?this.media.getAttribute("poster")||this.media.getAttribute("data-poster"):null}get ratio(){if(!this.isVideo)return null;const s=b(T.call(this));return u.array(s)?s.join(":"):s}set ratio(s){if(!this.isVideo){this.debug.warn("Aspect ratio can only be set for video");return}if(!u.string(s)||!v(s)){this.debug.error(`Invalid aspect ratio specified (${s})`);return}this.config.ratio=b(s),S.call(this)}set autoplay(s){this.config.autoplay=u.boolean(s)?s:this.config.autoplay}get autoplay(){return!!this.config.autoplay}toggleCaptions(s){H.toggle.call(this,s,!1)}set currentTrack(s){H.set.call(this,s,!1),H.setup.call(this)}get currentTrack(){const{toggled:s,currentTrack:t}=this.captions;return s?t:-1}set language(s){H.setLanguage.call(this,s,!1)}get language(){return(H.getCurrentTrack.call(this)||{}).language}set pip(s){if(!J.pip)return;const t=u.boolean(s)?s:!this.pip;u.function(this.media.webkitSetPresentationMode)&&this.media.webkitSetPresentationMode(t?qt.active:qt.inactive),u.function(this.media.requestPictureInPicture)&&(!this.pip&&t?this.media.requestPictureInPicture():this.pip&&!t&&document.exitPictureInPicture())}get pip(){return J.pip?u.empty(this.media.webkitPresentationMode)?this.media===document.pictureInPictureElement:this.media.webkitPresentationMode===qt.active:null}setPreviewThumbnails(s){this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),Object.assign(this.config.previewThumbnails,s),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new Xt(this))}static supported(s,t){return J.check(s,t)}static loadSprite(s,t){return Qt(s,t)}static setup(s,t={}){let o=null;return u.string(s)?o=Array.from(document.querySelectorAll(s)):u.nodeList(s)?o=Array.from(s):u.array(s)&&(o=s.filter(u.element)),u.empty(o)?null:o.map(l=>new gt(l,t))}}return gt.defaults=Bt(ti),gt});
